<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>N&uacute;meros primos</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <h1 id="números-primos">Números primos</h1>
<h2 id="checagem-rápida-de-se-um-número-é-primo">Checagem rápida de se um número é primo</h2>
<p>Se retornar false então é 100% de certeza que não é primo, mas não garante que é primo se retornar True. Aumentar o <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> aumenta a certeza.</p>
<pre><code class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkComposite</span>(<span class="hljs-params">n,a,d,s</span>):
    x = <span class="hljs-built_in">pow</span>(a, d, n)
    <span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x == n-<span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, s):
        x = (x * x) % n
        <span class="hljs-keyword">if</span> x == n-<span class="hljs-number">1</span>: 
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">isPrime</span>(<span class="hljs-params">n, k=<span class="hljs-number">5</span></span>): <span class="hljs-comment"># miller-rabin</span>
    <span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint
    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">2</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">13</span>,<span class="hljs-number">17</span>,<span class="hljs-number">19</span>,<span class="hljs-number">23</span>,<span class="hljs-number">29</span>]:
       <span class="hljs-keyword">if</span> n % p == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> n == p
    s, d = <span class="hljs-number">0</span>, n-<span class="hljs-number">1</span>
    <span class="hljs-keyword">while</span> d % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:
        s, d = s+<span class="hljs-number">1</span>, d//<span class="hljs-number">2</span>
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):
        a = randint(<span class="hljs-number">2</span>, n-<span class="hljs-number">1</span>)
        <span class="hljs-keyword">if</span> checkComposite(n,a,d,s):
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
</code></pre>
<pre><code class="language-C++"><span class="hljs-meta">#<span class="hljs-keyword">define</span> ll unsigned long long</span>

<span class="hljs-function">ll <span class="hljs-title">powmod</span><span class="hljs-params">(ll base, ll e, ll mod)</span></span>;

<span class="hljs-function">ll <span class="hljs-title">mulpow</span><span class="hljs-params">(ll base, ll e, ll mod)</span></span>;<span class="hljs-comment">// Multiplicação com módulo</span>
<span class="hljs-comment">// Só é importante se a*b pode dar overflow, senão usar (a*b)%mod</span>

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">check_composite</span><span class="hljs-params">(ll n, ll a, ll d, <span class="hljs-type">int</span> s)</span> </span>{
    ll x = <span class="hljs-built_in">powmod</span>(a, d, n);
    <span class="hljs-keyword">if</span> (x == <span class="hljs-number">1</span> || x == n - <span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> r = <span class="hljs-number">1</span>; r &lt; s; r++) {
        x = <span class="hljs-built_in">mulpow</span>(x,x,n);
        <span class="hljs-keyword">if</span> (x == n - <span class="hljs-number">1</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
};
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isPrime</span><span class="hljs-params">(ll n)</span> </span>{ <span class="hljs-comment">// miller rabin returns true if n is prime, else returns false.</span>
    <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">2</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-type">int</span> r = <span class="hljs-number">0</span>;
    ll d = n - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> ((d &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span>) {
        d &gt;&gt;= <span class="hljs-number">1</span>;
        r++;
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> a : {<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">19</span>, <span class="hljs-number">23</span>, <span class="hljs-number">29</span>, <span class="hljs-number">31</span>, <span class="hljs-number">37</span>}) {
        <span class="hljs-keyword">if</span> (n == a)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">check_composite</span>(n, a, d, r))
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<p>De acordo com <a href="https://cp-algorithms.com/algebra/primality_tests.html#deterministic-version">esse site</a> é possivel ter uma versão do MillerRabin deterministica se for checado todas as bases até <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">2*ln(n)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>É provado também que para qualquer número inteiro de 64 bits é necessário checar apenas as 12 primeiros primos.</p>
<pre><code class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkComposite</span>(<span class="hljs-params">n,a,d,s</span>):
    x = <span class="hljs-built_in">pow</span>(a, d, n)
    <span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x == n-<span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, s):
        x = (x * x) % n
        <span class="hljs-keyword">if</span> x == n-<span class="hljs-number">1</span>: 
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">isPrime</span>(<span class="hljs-params">n</span>): <span class="hljs-comment"># miller-rabin deterministico para 64 bits</span>
    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">2</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    s, d = <span class="hljs-number">0</span>, n-<span class="hljs-number">1</span>
    <span class="hljs-keyword">while</span> d % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:
        s, d = s+<span class="hljs-number">1</span>, d//<span class="hljs-number">2</span>
    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">19</span>, <span class="hljs-number">23</span>, <span class="hljs-number">29</span>, <span class="hljs-number">31</span>, <span class="hljs-number">37</span>]: <span class="hljs-comment"># 12 primeiros primos</span>
        <span class="hljs-keyword">if</span> n==a:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">if</span> checkComposite(n,a,d,s):
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
</code></pre>
<h2 id="algoritmo-sieve-pré-computar-primos">Algoritmo Sieve (Pré-computar primos)</h2>
<p>Sieve: Algoritmo para verificar se um número é primo.</p>
<p>O algoritmo computa todos os números primos antes (função sieve()) para que depois a  verificação seja através da função prime(int p), onde p é o número que se deseja testar.</p>
<pre><code class="language-c++"><span class="hljs-meta">#<span class="hljs-keyword">define</span> SIEVE_SIZE 1000</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bitset&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-type">int</span> N;
<span class="hljs-type">int</span> C;
vector&lt;<span class="hljs-type">int</span>&gt; primes;
bitset&lt;SIEVE_SIZE+2&gt; bs;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">sieve</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-type">int</span> i, j, max = SIEVE_SIZE + <span class="hljs-number">1</span>;
    bs.<span class="hljs-built_in">reset</span>();
    bs.<span class="hljs-built_in">flip</span>();
    bs.<span class="hljs-built_in">set</span>(<span class="hljs-number">0</span>, <span class="hljs-literal">false</span>);
    bs.<span class="hljs-built_in">set</span>(<span class="hljs-number">1</span>, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">for</span>( i=<span class="hljs-number">2</span>; i &lt;= max; i++ )
    {
        <span class="hljs-keyword">if</span>( bs.<span class="hljs-built_in">test</span>(i) == <span class="hljs-literal">true</span> ) <span class="hljs-comment">// i é primo, e todos os múltiplos de i nao</span>
        {
            primes.<span class="hljs-built_in">push_back</span>( i );
            <span class="hljs-keyword">for</span>( j = i*i; j &lt;= max; j += i )
            {
                bs.<span class="hljs-built_in">set</span>(j, <span class="hljs-literal">false</span>);
            }
        }
    }
}

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isPrime</span><span class="hljs-params">(<span class="hljs-type">int</span> p)</span>
</span>{
    <span class="hljs-keyword">if</span>( p &lt; SIEVE_SIZE )
       <span class="hljs-keyword">return</span> bs.<span class="hljs-built_in">test</span>(p);
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt; primes.<span class="hljs-built_in">size</span>()<span class="hljs-number">-1</span>; i++)
    {
        <span class="hljs-keyword">if</span>( p % primes[i] == <span class="hljs-number">0</span> )
           <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<h2 id="sieve-em-python-comparação">Sieve em Python (comparação)</h2>
<pre><code class="language-python"><span class="hljs-keyword">import</span> math
<span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> compress
<span class="hljs-keyword">import</span> timeit

<span class="hljs-keyword">def</span> <span class="hljs-title function_">sieve</span>(<span class="hljs-params">n</span>):
    <span class="hljs-string">&quot;Primes less than n&quot;</span>
    <span class="hljs-comment"># sieve(30) --&gt; 2 3 5 7 11 13 17 19 23 29</span>
    data = <span class="hljs-built_in">bytearray</span>((<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) * (n // <span class="hljs-number">2</span>)
    data[:<span class="hljs-number">3</span>] = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>
    limit = math.isqrt(n) + <span class="hljs-number">1</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> compress(<span class="hljs-built_in">range</span>(limit), data):
        data[p*p : n : p+p] = <span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">range</span>(p*p, n, p+p)))
    data[<span class="hljs-number">2</span>] = <span class="hljs-number">1</span>
    i = -<span class="hljs-number">1</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            <span class="hljs-keyword">yield</span> (i := data.index(<span class="hljs-number">1</span>, i+<span class="hljs-number">1</span>))
    <span class="hljs-keyword">except</span> ValueError:
        <span class="hljs-keyword">pass</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">SieveOfEratosthenes</span>(<span class="hljs-params">num</span>):
    prime = [<span class="hljs-literal">True</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num+<span class="hljs-number">1</span>)]
    <span class="hljs-comment"># boolean array</span>
    p = <span class="hljs-number">2</span>
    <span class="hljs-keyword">while</span> (p * p &lt;= num):
 
        <span class="hljs-comment"># If prime[p] is not</span>
        <span class="hljs-comment"># changed, then it is a prime</span>
        <span class="hljs-keyword">if</span> (prime[p] == <span class="hljs-literal">True</span>):
 
            <span class="hljs-comment"># Updating all multiples of p</span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(p * p, num+<span class="hljs-number">1</span>, p):
                prime[i] = <span class="hljs-literal">False</span>
        p += <span class="hljs-number">1</span>
 
    <span class="hljs-comment"># Print all prime numbers</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, num+<span class="hljs-number">1</span>):
        <span class="hljs-keyword">if</span> prime[p]:
            <span class="hljs-keyword">yield</span> p

<span class="hljs-built_in">print</span>(timeit.timeit(<span class="hljs-keyword">lambda</span>: <span class="hljs-built_in">list</span>(sieve(<span class="hljs-number">1_000_000</span>)), number=<span class="hljs-number">1</span>))
<span class="hljs-comment"># 0.013812200020765886</span>
<span class="hljs-built_in">print</span>(timeit.timeit(<span class="hljs-keyword">lambda</span>: <span class="hljs-built_in">list</span>(SieveOfEratosthenes(<span class="hljs-number">1_000_000</span>)), number=<span class="hljs-number">1</span>))
<span class="hljs-comment"># 0.0916068000078667v</span>

</code></pre>
<h2 id="prime-factor">Prime Factor</h2>
<p>Retorna o menor fator primo de um valor n.</p>
<p>Ex: 6 = 2 * 3. No caso o menor valor é o 2 então este será retornado.
Se n for primo, o próprio n será retornado.</p>
<pre><code class="language-c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">primeFactor</span> <span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
</span>{
	<span class="hljs-comment">// Don&#x27;t bother to use abs () &lt;stdlib.h&gt;</span>
	<span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">0</span>)
		n = -n;
	<span class="hljs-comment">// For n &lt; 2; it is just n</span>
	<span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">2</span>)
		<span class="hljs-keyword">return</span> n;

	<span class="hljs-comment">// otherwise, for an even number it is 2</span>
	<span class="hljs-keyword">if</span> (n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)
		<span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;

	<span class="hljs-comment">// for other odd numbers, search for a divisor</span>
	<span class="hljs-comment">// until SQRT (n) [conceptual] n / div &gt;= div is</span>
	<span class="hljs-comment">// equivalent to SQRT (n) &gt;= div</span>
	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> div = <span class="hljs-number">3</span>; n / div &gt;= div; div += <span class="hljs-number">2</span>)
	{
		<span class="hljs-comment">// if div is a divisor, just return it.</span>
		<span class="hljs-keyword">if</span> (n % div == <span class="hljs-number">0</span>)
			<span class="hljs-keyword">return</span> div;
	}

	<span class="hljs-comment">// There is no divisor (n is prime), return it.</span>
	<span class="hljs-keyword">return</span> n;
}
</code></pre>
<h1 id="fatorização">Fatorização</h1>
<p>A fatorização de um número é a decomposição de um números pelos seus primos geradores. Por exemplo o número 24 pode ser decomposto em: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo><mn>2</mn><mo>∗</mo><mn>2</mn><mo>∗</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2*2*2*3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> ou <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup><mo>∗</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2^3*3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>.</p>
<p>Antes de usar o algoritmo de fatorização, checar se o número é primo usando algum teste de primalidade.</p>
<h2 id="wheel-factorization">Wheel factorization</h2>
<p>A função abaixo faz a fatorização de um número pelos seus primos. Ela pode ser otimizada se já houver uma lista de primos pré computados. Para primos muito grandes essa função pode levar um tempo para fatorizar.</p>
<pre><code class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">factorization</span>(<span class="hljs-params">number</span>):
    solution = []
    <span class="hljs-keyword">while</span> number&amp;<span class="hljs-number">1</span>==<span class="hljs-number">0</span>:
        number//=<span class="hljs-number">2</span>
        solution.append(<span class="hljs-number">2</span>)
    i = <span class="hljs-number">3</span>
    <span class="hljs-keyword">while</span> math.sqrt(number) &gt; i:
        <span class="hljs-keyword">while</span> number % i == <span class="hljs-number">0</span>:
            number //= i 
            solution.append(i)
        i += <span class="hljs-number">2</span>
    <span class="hljs-keyword">if</span> number!=<span class="hljs-number">1</span>:
        solution.append(number)
    <span class="hljs-keyword">return</span> solution
</code></pre>
<h2 id="se-tiver-um-sieve-pré-computado-até-sqrtn-é-melhor-usar-essa-versão">Se tiver um sieve pré-computado (até sqrt(n)) é melhor usar essa versão:</h2>
<pre><code class="language-python"><span class="hljs-keyword">import</span> math
<span class="hljs-keyword">import</span> timeit

<span class="hljs-keyword">def</span> <span class="hljs-title function_">factor</span>(<span class="hljs-params">n, primes</span>):
    <span class="hljs-string">&quot;Prime factors of n.&quot;</span>
    <span class="hljs-comment"># factor(99) --&gt; 3 3 11</span>
    <span class="hljs-keyword">for</span> prime <span class="hljs-keyword">in</span> primes:
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            quotient, remainder = <span class="hljs-built_in">divmod</span>(n, prime)
            <span class="hljs-keyword">if</span> remainder:
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">yield</span> prime
            n = quotient
            <span class="hljs-keyword">if</span> n == <span class="hljs-number">1</span>:
                <span class="hljs-keyword">return</span>
    <span class="hljs-keyword">if</span> n &gt; <span class="hljs-number">1</span>:
        <span class="hljs-keyword">yield</span> n

n = <span class="hljs-number">1_000_000</span>
primes = sieve(math.isqrt(n) + <span class="hljs-number">1</span>) <span class="hljs-comment"># isqrt é a int(sqrt(n)) ou raiz inteira</span>

</code></pre>
<h2 id="brents-algorithm">Brent's algorithm</h2>
<p>Esse algoritmo é bem complexo, leia mais <a href="https://cp-algorithms.com/algebra/factorization.html#brents-algorithm">aqui</a>.</p>
<pre><code class="language-C++">
<span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> a, <span class="hljs-type">long</span> <span class="hljs-type">long</span> b)</span></span>; <span class="hljs-comment">// Maior divisor comum</span>

<span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">mulpow</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> a, <span class="hljs-type">long</span> <span class="hljs-type">long</span> b, <span class="hljs-type">long</span> <span class="hljs-type">long</span> mod)</span></span>; <span class="hljs-comment">// Multiplicação com módulo</span>
<span class="hljs-comment">// Só é importante se a*b pode dar overflow, senão usar (a*b)%mod</span>

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isPrime</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> i)</span></span>; <span class="hljs-comment">// Fast primality check</span>

<span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">f</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> x, <span class="hljs-type">long</span> <span class="hljs-type">long</span> c, <span class="hljs-type">long</span> <span class="hljs-type">long</span> mod)</span> </span>{
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">mulpow</span>(x, x, mod) + c) % mod;
}

<span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">brent</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> n)</span> </span>{
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> x = x0;
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> g = <span class="hljs-number">1</span>;
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> q = <span class="hljs-number">1</span>;
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> xs, y;
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> x0=<span class="hljs-number">2</span>;
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> c=<span class="hljs-number">1</span>;

    <span class="hljs-type">int</span> m = <span class="hljs-number">128</span>;
    <span class="hljs-type">int</span> l = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (g == <span class="hljs-number">1</span>) {
        y = x;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; l; i++)
            x = <span class="hljs-built_in">f</span>(x, c, n);
        <span class="hljs-type">int</span> k = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (k &lt; l &amp;&amp; g == <span class="hljs-number">1</span>) {
            xs = x;
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m &amp;&amp; i &lt; l - k; i++) {
                x = <span class="hljs-built_in">f</span>(x, c, n);
                q = <span class="hljs-built_in">mulpow</span>(q, <span class="hljs-built_in">abs</span>(y - x), n);
            }
            g = <span class="hljs-built_in">gcd</span>(q, n);
            k += m;
        }
        l *= <span class="hljs-number">2</span>;
    }
    <span class="hljs-keyword">if</span> (g == n) {
        <span class="hljs-keyword">do</span> {
            xs = <span class="hljs-built_in">f</span>(xs, c, n);
            g = <span class="hljs-built_in">gcd</span>(<span class="hljs-built_in">abs</span>(xs - y), n);
        } <span class="hljs-keyword">while</span> (g == <span class="hljs-number">1</span>);
    }
    <span class="hljs-keyword">return</span> g;
}

<span class="hljs-function">vector&lt;<span class="hljs-type">long</span> <span class="hljs-type">long</span>&gt; <span class="hljs-title">fast_factorization</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> num)</span></span>{
    vector&lt;<span class="hljs-type">long</span> <span class="hljs-type">long</span>&gt; vec;
    <span class="hljs-keyword">while</span>(num&gt;<span class="hljs-number">1</span>){
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isPrime</span>(num)){
            vec.<span class="hljs-built_in">push_back</span>(num);
            <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-type">long</span> <span class="hljs-type">long</span> val = <span class="hljs-built_in">brent</span>(num);
        <span class="hljs-keyword">while</span>(num%val==<span class="hljs-number">0</span>){
            num/=val;
            vec.<span class="hljs-built_in">push_back</span>(val);
        }
    }
    <span class="hljs-keyword">return</span> vec;
}
</code></pre>
<h2 id="quebrando-o-rsa">Quebrando o RSA</h2>
<p>Uma maneira de encontrar os 2 primos multiplos que formam uma chave é usando o algoritmo abaixo. Ainda é lento para quando os números são muito grandes, porém consegue ser viavel para chaves de até 256 bits.</p>
<pre><code class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find2FactorsOfNumber</span>(<span class="hljs-params">n</span>):
    a = math.isqrt(n) + <span class="hljs-number">1</span>
    <span class="hljs-comment"># diff between two consecutives squares</span>
    diff = (a+<span class="hljs-number">1</span>)**<span class="hljs-number">2</span> - a**<span class="hljs-number">2</span>
    a2 = a**<span class="hljs-number">2</span>
    <span class="hljs-comment"># If N is prime this will loop forever</span>
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        <span class="hljs-comment"># this line can be omitted if you use </span>
        <span class="hljs-comment"># the diff between two consecutives squares</span>
        <span class="hljs-comment">#a2 = a**2</span>
        b2 = a2 - n

        <span class="hljs-comment"># this is the slowest part of the code</span>
        <span class="hljs-comment"># if you can check if b2 is a perfect square</span>
        <span class="hljs-comment"># faster this code can be optimized.</span>
        <span class="hljs-keyword">if</span> math.isqrt(b2)**<span class="hljs-number">2</span> == b2:
            b = math.isqrt(b2)
            <span class="hljs-built_in">print</span>(a,b)
            <span class="hljs-built_in">print</span>(a2-b2 == n,(a+b)*(a-b) == n)
            <span class="hljs-keyword">break</span>

        a2 += diff
        <span class="hljs-comment"># update diff</span>
        diff += <span class="hljs-number">2</span>

        a += <span class="hljs-number">1</span>
    <span class="hljs-comment"># Return p and q that p*q == n</span>
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(a-b),<span class="hljs-built_in">int</span>(a+b))
</code></pre>
<p>Se passado um número para a função ela irá retornar 2 números inteiros tal que se multiplicados resulta no número passado. Se não houver 2 números tal que gere um resultado válido, vai ficar em loop infinito.</p>
<h1 id="aritimética-modular">Aritimética modular</h1>
<p>Na matemática, a aritmética modular é um sistema de aritmética para números inteiros, onde os números &quot;envolvem&quot; ao atingir um determinado valor, chamado de módulo.</p>
<p>A definição de módulo é dada por:</p>
<p>Dado um inteiro <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \gt 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> , chamado módulo, e dois inteiros <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> são ditos congruentes módulo <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, se e somente se <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> é um divisor da diferença entre eles.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>−</mo><mi>b</mi><mo>=</mo><mi>k</mi><mo>∗</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">    a - b = k*n
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span></p>
<p>Para <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∈</mo><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">k \in \mathbb{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">Z</span></span></span></span></p>
<p>Logo é dito que:</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>≡</mo><mi>b</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    a \equiv b (\mathrm{mod}\ n)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p>
<p>Note que pela notação o trecho <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> deve aparecer sempre ao lado direito da equação e é aplicado a ambos os lados da equação, e não só ao lado em que ele aparece. Ou seja, ambos os exemplos abaixo são verdade:</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>4</mn><mo>≡</mo><mn>9</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mn>5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    4 \equiv 9 (\mathrm{mod}\ 5)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">9</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>9</mn><mo>≡</mo><mn>4</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mn>5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    9 \equiv 4 (\mathrm{mod}\ 5)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="numeros-negativos">Numeros negativos</h2>
<p>A definição de congruencia também é aplicada a valores negativos. Por exemplo:</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>2</mn><mo>≡</mo><mo>−</mo><mn>3</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mn>5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    2 \equiv -3 (\mathrm{mod}\ 5)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord">3</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>−</mo><mn>8</mn><mo>≡</mo><mn>7</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mn>5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    -8 \equiv 7 (\mathrm{mod}\ 5)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">7</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>−</mo><mn>3</mn><mo>≡</mo><mo>−</mo><mn>8</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mn>5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    -3 \equiv -8 (\mathrm{mod}\ 5)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord">8</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span></p>
<p>Perceba que pela definição, o módulo de um número não pode ser negativo. E que o módulo de um número negativo pode ser diferente para o mesmo número absoluto.</p>
<h2 id="propriedades">Propriedades</h2>
<p>Primeiramente, a relação de módulo satisfazem todas as condições de relação de equivalência:</p>
<ul>
<li>Reflexividade: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≡</mo><mi>a</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a\equiv a(\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li>Simetria: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≡</mo><mi>b</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a\equiv b(\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> se <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>≡</mo><mi>a</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b\equiv a(\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> para todo <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></li>
<li>Transitividade: Se <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≡</mo><mi>b</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a\equiv b(\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>≡</mo><mi>c</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b\equiv c(\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> então <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≡</mo><mi>c</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a\equiv c(\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>Seja <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>≡</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_1 \equiv b_1 (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6138em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>2</mn></msub><mo>≡</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_2 \equiv b_2 (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6138em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≡</mo><mi>b</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a \equiv b (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∈</mo><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">k \in \mathbb{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">Z</span></span></span></span> então:</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>+</mo><mi>k</mi><mo>≡</mo><mi>b</mi><mo>+</mo><mi>k</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a+k\equiv b+k (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi mathvariant="normal">.</mi><mi>k</mi><mo>≡</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>k</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a.k\equiv b.k (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">a</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi mathvariant="normal">.</mi><mi>k</mi><mo>≡</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>k</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mi mathvariant="normal">.</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a.k\equiv b.k (\mathrm{mod}\ n.k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">a</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>≡</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_1+a_2\equiv b_1+b_2 (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6138em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> Compatibilidade com soma</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>−</mo><msub><mi>a</mi><mn>2</mn></msub><mo>≡</mo><msub><mi>b</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_1-a_2\equiv b_1+b_2 (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6138em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> Compatibilidade com subtração</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><msub><mi>a</mi><mn>2</mn></msub><mo>≡</mo><msub><mi>b</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><msub><mi>b</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_1.a_2\equiv b_1.b_2 (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6138em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> Compatibilidade com multiplicação</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>k</mi></msup><mo>≡</mo><msup><mi>b</mi><mi>k</mi></msup><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^k\equiv b^k (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> Para <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> não negativo. Compatibilidade com exponenciação</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>≡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(a)\equiv p(b) (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> Para qualquer função polinomial <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> com coeficientes inteiros.</li>
</ul>
<p>Se <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≡</mo><mi>b</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a\equiv b (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, é geralmente falsto que <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mi>a</mi></msup><mo>≡</mo><msup><mi>k</mi><mi>b</mi></msup><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k^a \equiv k^b (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>, porém a seguinte regra é verdade:</p>
<ul>
<li>Se <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>≡</mo><mi>d</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c\equiv d (\mathrm{mod}\ φ(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>, onde <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>φ</mi></mrow><annotation encoding="application/x-tex">φ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">φ</span></span></span></span> é a <a href="https://en.wikipedia.org/wiki/Euler%27s_totient_function">função tociente de Euler</a>, então <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>c</mi></msup><mo>≡</mo><msup><mi>a</mi><mi>d</mi></msup><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^c \equiv a^d (\mathrm{mod}\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> desde que <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> seja <a href="https://en.wikipedia.org/wiki/Coprime_integers">coprimo</a> de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>.</li>
</ul>
<h2 id="multiplicação-com-módulo">Multiplicação com módulo</h2>
<p>Para linguagens como C/C++ que um inteiro pode overflow, existem casos que queremos multiplicar 2 números e o resultado pode não caber em um inteiro de 64 bits. O algoritmo abaixo faz a multiplicação em O(log n) com módulo evitando o overflow.</p>
<pre><code class="language-C"><span class="hljs-meta">#<span class="hljs-keyword">define</span> ll long long int</span>

ll <span class="hljs-title function_">mulpow</span><span class="hljs-params">(ll a, ll b, ll mod)</span> {
    ll res = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (b &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (b &amp; <span class="hljs-number">1</span>)
            res = (res + a) % mod;
        a = (a + a) % mod;
        b &gt;&gt;= <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> res;
}
</code></pre>
<h2 id="potencia-com-módulo">Potencia com Módulo</h2>
<p>Para potencia com módulo, em C temos o seguinte código:</p>
<pre><code class="language-c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> ll long long int</span>

<span class="hljs-comment">// Fast pow and mod</span>
ll <span class="hljs-title function_">powmod</span><span class="hljs-params">(ll base, ll <span class="hljs-built_in">exp</span>, ll modulus)</span> {
    base %= modulus;
    ll result = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">exp</span> &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">exp</span> &amp; <span class="hljs-number">1</span>) result = mulpow(result, base, modulus);
        base = mulpow(base ,base , modulus);
        <span class="hljs-built_in">exp</span> &gt;&gt;= <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> result;
}
</code></pre>
<p>Caso a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>a</mi><mi>s</mi><msup><mi>e</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">base^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord mathnormal">ba</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> não de overflow, é possivel substituir a função mulpow apenas por <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mi>e</mi><mi>s</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi mathvariant="normal">.</mi><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>l</mi><mi>u</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">(result.base)\mathrm{mod}\ modulus</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">res</span><span class="mord mathnormal">u</span><span class="mord mathnormal">lt</span><span class="mord">.</span><span class="mord mathnormal">ba</span><span class="mord mathnormal">se</span><span class="mclose">)</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy="false">)</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>l</mi><mi>u</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">(base.base)\mathrm{mod}\ modulus</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">ba</span><span class="mord mathnormal">se</span><span class="mord">.</span><span class="mord mathnormal">ba</span><span class="mord mathnormal">se</span><span class="mclose">)</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span></span></span></span> nos dois casos em que ela é usada.</p>
<p>Em python temos a função powmod implementada nativamente na função <code>pow</code>. O primeiro parametro é a base, o segundo o expoente e o terceiro é o módulo.</p>
<h2 id="inverso-modular">Inverso Modular</h2>
<p>O inverso modular de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> com módulo <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> é um número <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> tal que, quando multiplicado com <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>, gera um valor cujo resto da divisão com <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> é 1. Ou seja, <p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mi>x</mi><mo>≡</mo><mn>1</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ax \equiv1 (\mathrm{mod}\ m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4637em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span></p>
</p>
<p><strong>Notação:</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">a^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>Exemplo:</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">a = 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">m = 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span> resulta em <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">a^{-1} = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> , pois <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>∗</mo><mn>5</mn><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">3 * 5 = 15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">15</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>15</mn><mo>≡</mo><mn>1</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mn>7</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">15 \equiv1 (\mathrm{mod}\ 7)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">15</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord">7</span><span class="mclose">)</span></span></span></span></p>
<p><strong>OBS:</strong> O inverso modular existe se, e somente se, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> forem coprimos (ou primos entre si), isto é: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>d</mi><mi>c</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">mdc(a, m) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">d</span><span class="mord mathnormal">c</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>.</p>
<p>O algoritmo para calcular o inverso modular utiliza o algoritmo extendido de Euclides (<code>egcd</code>). Note que a função <code>modInv</code> retorna 0 caso não exista o inverso modular. É interessante apontar que questões que envolvem módulo - na maioria das vezes - possuem um número <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> primo (geralemente, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">10^9 + 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span>). Isso garante que o inverso modular irá existir caso <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> não seja múltiplo de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>. Portanto, dependendo da questão, pode-se remover a verificação da função <code>modInv</code>.</p>
<p>(NÃO TESTADO)</p>
<pre><code class="language-python"><span class="hljs-comment"># algoritmo extendido de Euclides</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">egcd</span>(<span class="hljs-params">a, b</span>):
    <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> (b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
    <span class="hljs-keyword">else</span>:
        g, y, x = egcd(b % a, a)
        <span class="hljs-keyword">return</span> (g, x - (b // a) * y, y)

<span class="hljs-comment"># a^-1 mod m = 1</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">modInv</span>(<span class="hljs-params">a, m</span>):
    g, x, y = egcd(a, m)
    <span class="hljs-keyword">if</span> g != <span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> <span class="hljs-comment"># inverso modular não existe</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> x % m
</code></pre>
<h1 id="combinatória-modular">Combinatória modular</h1>
<p>Fermat’s little theorem and modular inverse
Fermat’s little theorem states that if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> is a prime number, then for any integer a, the number <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>p</mi></msup><mtext>–</mtext><mi>a</mi></mrow><annotation encoding="application/x-tex">a^p – a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mord">–</span><span class="mord mathnormal">a</span></span></span></span> is an integer multiple of p. In the notation of modular arithmetic, this is expressed as:</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mi>p</mi></msup><mo>=</mo><mi>a</mi><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^p = a (\mathrm{mod}\ p) 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p>
<p>For example, if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">a = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">p = 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span> so <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>7</mn></msup><mo>=</mo><mn>128</mn></mrow><annotation encoding="application/x-tex">2^7 = 128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">128</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>128</mn><mtext>–</mtext><mn>2</mn><mo>=</mo><mn>7</mn><mo>×</mo><mn>18</mn></mrow><annotation encoding="application/x-tex">128 – 2 = 7 × 18</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">128–2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">18</span></span></span></span> is an integer multiple of 7.</p>
<p>If a is not divisible by p, Fermat’s little theorem is equivalent to the statement <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mtext>–</mtext><mn>1</mn></mrow></msup><mtext>–</mtext><mn>1</mn></mrow><annotation encoding="application/x-tex">a^{p–1} – 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mtight">–1</span></span></span></span></span></span></span></span></span><span class="mord">–1</span></span></span></span> is an integer multiple of p, i.e</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>1</mn><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^{p-1} = 1 (\mathrm{mod}\ p)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p>
<p>If we multiply both sides by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">a^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>, we get.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a^{p-2} = a^{-1} (\mathrm{mod}\ p)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p>
<p>Código em python: (Precisa testar, não acredito que esteja dando a resposta certa)</p>
<pre><code class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">comb_mod</span>(<span class="hljs-params">n, p, MOD</span>):
    <span class="hljs-comment"># initialize numerator and denominator</span>
    num = den = <span class="hljs-number">1</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(p):
        num = (num * (n - i)) % MOD
        den = (den * (i + <span class="hljs-number">1</span>)) % MOD
    <span class="hljs-keyword">return</span> (num * <span class="hljs-built_in">pow</span>(den, MOD - <span class="hljs-number">2</span>, MOD)) % MOD 
</code></pre>
<p>Dicas de otimização:</p>
<ul>
<li>Se o <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>O</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">MOD</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">MO</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> é constante, é possivel pre-computar o fatorial no inicio do programa.</li>
<li>Se o <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> é constante, é possivel pré-computar tudo e acessar como um array.</li>
</ul>
<pre><code class="language-python">MOD = <span class="hljs-number">10</span>**<span class="hljs-number">9</span> + <span class="hljs-number">7</span>
<span class="hljs-comment"># Precomputamos o fatorial</span>
factorials = [<span class="hljs-number">1</span>] * (<span class="hljs-number">10</span>**<span class="hljs-number">6</span> + <span class="hljs-number">1</span>)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">10</span>**<span class="hljs-number">6</span> + <span class="hljs-number">1</span>):
    factorials[i] = (factorials[i - <span class="hljs-number">1</span>] * i) % MOD

<span class="hljs-comment"># Poderiamos pre computar o inverso do fatorial</span>
<span class="hljs-comment"># Mas vamos usar o pow(den, MOD - 2, MOD) para calcular o invFatorial</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">combination_mod</span>(<span class="hljs-params">n, k, MOD</span>):
    <span class="hljs-keyword">if</span> k &gt; n:
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    num = factorials[n]
    den = (factorials[k] * factorials[n- k]) % MOD
    <span class="hljs-keyword">return</span> (num * <span class="hljs-built_in">pow</span>(den, MOD - <span class="hljs-number">2</span>, MOD)) % MOD   
</code></pre>
<h3 id="não-faz-sentido-esse-código-em-c">Não faz sentido esse código em c++!</h3>
<p>Exemplo do programa em c++ (Provavelmente errado!):</p>
<pre><code class="language-c++"><span class="hljs-comment">// fatorial já ta pre computado FAT[]</span>

<span class="hljs-type">const</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> MOD = XXXXXX    <span class="hljs-comment">// Funciona apenas para primos entre si, ou seja, se o MOD for primo vai funcionar</span>

<span class="hljs-comment">// Computar inv fatorial</span>
invFatorial[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>

<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> x=<span class="hljs-number">1</span>;x&lt;LIMIT;x++){
   invFatorial[x] = <span class="hljs-built_in">pow</span>(i,MOD<span class="hljs-number">-2</span>);
}

<span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">comb_mob</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> n, <span class="hljs-type">long</span> <span class="hljs-type">long</span> p)</span>
</span>{
   <span class="hljs-comment">// O resto da divisão de (n p) = (n!/(p!(n-p)!)) modulo q poder ser calculado da senguinte forma:</span>
   <span class="hljs-comment">// FAT[n]*INV[n-p]*INV[p]%MOD</span>
   <span class="hljs-type">long</span> <span class="hljs-type">long</span> resp = fatorial[n]*invFatorial[n-p];
   resp %= MOD;
   resp *= invFatorial[p];
   resp %= MOD;
   <span class="hljs-keyword">return</span> resp;
}
</code></pre>
<h2 id="algoritmos-testados">Algoritmos TESTADOS</h2>
<p>Para calcular uma combinatória mod <code>mod</code> é preciso pré-computar os fatoriais mod <code>mod</code> de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> até o maior <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>.</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> é o total de elementos e <code>maxn</code> é o maior valor possível para <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>.</p>
<h3 id="pré-computar-fatoriais">Pré-computar fatoriais</h3>
<pre><code class="language-cpp">ll fatMod[maxn + <span class="hljs-number">1</span>];

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">precomputeFatMod</span><span class="hljs-params">()</span>
</span>{
    fatMod[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= maxn; i++)
    {
        fatMod[i] = fatMod[i - <span class="hljs-number">1</span>] * i % mod;
    }
}
</code></pre>
<h3 id="inverso-modular-1">Inverso Modular</h3>
<pre><code class="language-cpp"><span class="hljs-function">ll <span class="hljs-title">inv</span><span class="hljs-params">(ll a)</span>
</span>{
    <span class="hljs-keyword">return</span> a &lt;= <span class="hljs-number">1</span> ? a : mod - (<span class="hljs-type">long</span> <span class="hljs-type">long</span>)(mod / a) * <span class="hljs-built_in">inv</span>(mod % a) % mod;
}
</code></pre>
<h3 id="pré-computar-o-inverso-modular">Pré-computar o inverso Modular?</h3>
<p>Para pré-computar o inverso modular, pode-se usar programação dinânmica partindo da solução recursiva acima. Porém, acredito que não seja
recomendado, pois, o vetor teria que ter tamanho <code>mod</code>, ou seja, teria que guardar todos os valores entre 1 e <code>mod - 1</code>. Geralmente,
<code>mod = 10^9 + 7</code>, que é muito grande.</p>
<h3 id="combinatória-módulo-mod">Combinatória Módulo <code>mod</code></h3>
<pre><code class="language-cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">combMod</span><span class="hljs-params">(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span> k)</span>
</span>{
    <span class="hljs-keyword">return</span> fatMod[n] * <span class="hljs-built_in">inv</span>(fatMod[k]) % mod * <span class="hljs-built_in">inv</span>(fatMod[n - k]) % mod;
}
</code></pre>
<h1 id="encontrando-a-potência-de-um-divisor-de-fatorial-fórmula-de-legendre">Encontrando a potência de um divisor de fatorial (Fórmula de Legendre)</h1>
<p>Algoritmo para encontrar o maior <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> tal que <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">k ^ x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span> divide <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">n!</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span>.</p>
<p><strong>Complexidade:</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<h2 id="caso-k-seja-primo">Caso <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> seja primo</h2>
<pre><code class="language-cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">fact_pow</span> <span class="hljs-params">(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span> k)</span>
</span>{
    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (n)
    {
        n /= k;
        res += n;
    }

    <span class="hljs-keyword">return</span> res;
}
</code></pre>
<h2 id="caso-k-não-seja-primo-k-composto">Caso <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> não seja primo (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> composto)</h2>
<p>No algoritmo abaixo, <code>factors</code> é um vetor que guarda os fatores primos que formam <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>. Ele guarda um par, pois o primeiro
é o fator em si, e o segundo, a potência a ele associada.</p>
<p>Para exemplificar: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>60</mn><mo>=</mo><msup><mn>2</mn><mn>2</mn></msup><mo>∗</mo><mn>3</mn><mo>∗</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">60 = 2^2 * 3 * 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">60</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span></p>
<p>Logo, para representar 60, seria necessário montar um vetor com os seguintes valores:</p>
<ul>
<li>{2, 2}</li>
<li>{3, 1}</li>
<li>{5, 1}</li>
</ul>
<p><strong>OBS:</strong> os primos não precisam estar em ordem.</p>
<pre><code class="language-cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">fact_pow</span><span class="hljs-params">(<span class="hljs-type">int</span> n, vector&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt; factors)</span>
</span>{
    <span class="hljs-type">int</span> resp = <span class="hljs-number">1000000</span>;
    <span class="hljs-type">int</span> aux;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> p : factors)
    {
        aux = <span class="hljs-built_in">fact_pow</span>(n, p.first);
        aux /= p.second;

        <span class="hljs-keyword">if</span>(resp &gt; aux)
        {
            resp = aux;
        }
    }

    <span class="hljs-keyword">return</span> resp;
}
</code></pre>
<h2 id="máximo-divisor-comum--greatest-common-divisor">Máximo Divisor Comum / Greatest Common Divisor</h2>
<p>Calcula o máximo divisor entre 'a' e 'b'</p>
<p>Ex: gcd(12, 8) = 4</p>
<pre><code class="language-c++"><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> a, <span class="hljs-type">long</span> <span class="hljs-type">long</span> b)</span> </span>{ 
   <span class="hljs-keyword">while</span> (b &gt; <span class="hljs-number">0</span>) { 
      a = a % b; 
      a ^= b;    b ^= a;    a ^= b;  
   }  
   <span class="hljs-keyword">return</span> a; 
} 
</code></pre>
<h2 id="mínimo-múltiplo-comum">Mínimo Múltiplo Comum</h2>
<p>Procura o menor valor que seja múltiplo de 'a' e 'b'</p>
<p>Ex: mmc(3, 4) = 12</p>
<p><strong>OBS: Utiliza a fórmula do gdc</strong></p>
<pre><code class="language-c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span> <span class="hljs-comment">/*para poder utilizar o abs(int)*/</span></span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">mmc</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span>
</span>{
   <span class="hljs-keyword">return</span> <span class="hljs-built_in">abs</span>(a * b) / <span class="hljs-built_in">gdc</span>(a,b);
}
</code></pre>
<p><strong>OBS: mmc(a, b, c) = mmc(mmc(a, b), c)</strong></p>
<h2 id="em-python-melhor">Em Python (melhor)</h2>
<pre><code class="language-python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd, lcm

<span class="hljs-built_in">print</span>(gcd(<span class="hljs-number">12</span>,<span class="hljs-number">8</span>)) <span class="hljs-comment"># maior divisor comum</span>
<span class="hljs-comment"># 4</span>

<span class="hljs-built_in">print</span>(lcm(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>)) <span class="hljs-comment"># menor multiplo comum</span>
<span class="hljs-comment"># 12</span>

</code></pre>
<h1 id="fibonacci">Fibonacci</h1>
<p>Na matemática, a sucessão de Fibonacci (ou sequência de Fibonacci), é uma sequência de números inteiros, começando normalmente por 0 e 1, na qual cada termo subsequente corresponde à soma dos dois anteriores.</p>
<p>Definição: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">fib(n) = fib(n-1) + fib(n-2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ib</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ib</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ib</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span>, para <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \gt 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>.
Note que <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">fib(0) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ib</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">fib(1) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ib</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>13</mn><mo separator="true">,</mo><mn>21</mn><mo separator="true">,</mo><mn>34</mn><mo separator="true">,</mo><mn>55</mn><mo separator="true">,</mo><mn>89</mn><mo separator="true">,</mo><mn>144</mn><mo separator="true">,</mo><mn>233</mn><mo separator="true">,</mo><mn>377</mn><mo separator="true">,</mo><mn>610</mn><mo separator="true">,</mo><mn>987</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">0,1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, ...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">13</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">21</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">34</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">55</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">89</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">144</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">233</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">377</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">610</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">987</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span></span></span></span></p>
<h2 id="teoria">Teoria</h2>
<p><strong>Teorema de Zeckendorf:</strong> Qualquer número inteiro positivo pode ser escrito como a soma de um ou mais números de Fibonacci distintos e não consecutivos. O fato dos números não serem consecutivos pode ser facilmente observado a partir da definição de Fibonacci: se o número for expresso pela soma de dois consecutivos, então pode ser expresso pelo próximo número da sequência.</p>
<p><strong>Pré-computar a sequência:</strong> O maior valor que um unsigned long long pode guardar da sequência é fib(93). Portanto, muito dificilmente será vantajoso utilizar essa técnica. A não ser que a questão trate, por exemplo, de fib(n) mod m, sendo m constante.</p>
<p><strong>Fórmula de Binet</strong>: Essa fórmula generaliza os termos da sequência. Uma desvantagem é que ao utilizar pontos flutuantes, é possivel se perder precisão durante o calculo e resultar na resposta errada. Por esse motivo, muito dificilmente será utilizada.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mfrac><mrow><mn>1</mn><mo>+</mo><msqrt><mn>5</mn></msqrt></mrow><mn>2</mn></mfrac><msup><mo stretchy="false">)</mo><mi>n</mi></msup><mo>−</mo><mo stretchy="false">(</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msqrt><mn>5</mn></msqrt></mrow><mn>2</mn></mfrac><msup><mo stretchy="false">)</mo><mi>n</mi></msup></mrow><msqrt><mn>5</mn></msqrt></mfrac></mrow><annotation encoding="application/x-tex">f(n) = {({1+\sqrt{5} \over 2 })^n - ({1-\sqrt{5} \over 2 })^n \over \sqrt{5}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.703em;vertical-align:-0.93em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.773em;"><span style="top:-2.2408em;"><span class="pstrut" style="height:3.038em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">5</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span><span style="top:-3.268em;"><span class="pstrut" style="height:3.038em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.773em;"><span class="pstrut" style="height:3.038em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.038em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.399em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">5</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.038em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.399em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">5</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<p>É possivel também chegar ao valor aproximado usando apenas uma parte da equação:</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mfrac><mrow><mn>1</mn><mo>+</mo><msqrt><mn>5</mn></msqrt></mrow><mn>2</mn></mfrac><msup><mo stretchy="false">)</mo><mi>n</mi></msup></mrow><msqrt><mn>5</mn></msqrt></mfrac></mrow><annotation encoding="application/x-tex">f(n) = {({1+\sqrt{5} \over 2 })^n \over \sqrt{5}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.703em;vertical-align:-0.93em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.773em;"><span style="top:-2.2408em;"><span class="pstrut" style="height:3.038em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">5</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span><span style="top:-3.268em;"><span class="pstrut" style="height:3.038em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.773em;"><span class="pstrut" style="height:3.038em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.038em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.399em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">5</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p>
<h2 id="período-de-pisano">Período de Pisano</h2>
<p>A sequência de Fibonacci mod M é sempre periódica. Ou seja, para um M no qual o periodo seja 6, como o Pisano de 4, fibonacci de 0 e o de 6 será o mesmo, e o de 1 e o 7 também, e assim por diante, de forma que a equação abaixo é verdadeira:</p>
<p>Função de Pisano = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi (k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></p>
<p><strong>OBS:</strong> Essa propriedade é muito útil para calcular <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>M</mi></mrow><annotation encoding="application/x-tex">fib(n) \bmod M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ib</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> quando n for um número muito grande, pois:</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>M</mi><mo>=</mo><mi>f</mi><mi>i</mi><mi>b</mi><mo stretchy="false">(</mo><mi>n</mi><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>π</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>M</mi></mrow><annotation encoding="application/x-tex">fib(n) \bmod M = fib(n \bmod \pi (M)) \bmod M
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ib</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">ib</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></p>
<p><em>Exemplo:</em></p>
<p>Fibonacci: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>13</mn><mo separator="true">,</mo><mn>21</mn><mo separator="true">,</mo><mn>34</mn><mo separator="true">,</mo><mn>55</mn><mo separator="true">,</mo><mn>89</mn><mo separator="true">,</mo><mn>144</mn><mo>…</mo></mrow><annotation encoding="application/x-tex">1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144 …</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">13</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">21</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">34</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">55</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">89</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">144</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span></p>
<p>Fibonacci (mod 4): <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo>…</mo></mrow><annotation encoding="application/x-tex">1, 1, 2, 3, 1, 0, 1, 1, 2, 3, 1, 0 …</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span></span></span></span></p>
<p>O período de Pisano de 4 é 6, pois, após 6 números, a sequência começa a se repetir.</p>
<p><strong>Obs:</strong>
Note que o Período de Pisano não serve para otimizar o cálculo, pois não existe fórmula para calculá-lo (deve ser feito de maneira iterativa), tendo complexidade <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p><strong>Algoritmo:</strong></p>
<pre><code class="language-c++"><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">pisano</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> m)</span>
</span>{
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> a = <span class="hljs-number">0</span>, b = <span class="hljs-number">1</span>, c = a + b;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; m * m; i++)
    {
        c = (a + b) % m;
        a = b;
        b = c;
        <span class="hljs-keyword">if</span> (a == <span class="hljs-number">0</span> &amp;&amp; b == <span class="hljs-number">1</span>)
            <span class="hljs-keyword">return</span> i + <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> m*m;
}
</code></pre>
<h2 id="algoritmos-para-calcular-fibn">Algoritmos para calcular fib(n)</h2>
<h2 id="recursivo---o2n">Recursivo - <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</h2>
<p>Esse algoritmo é, provavelmente, o mais famoso para encontrar um valor da sequência de Fibonacci. Porém, sua complexidade é muito alta e, dificilmente, será utilizado.</p>
<pre><code class="language-c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">fib</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
</span>{
    <span class="hljs-keyword">if</span>(n == <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">if</span>(n == <span class="hljs-number">1</span> || n == <span class="hljs-number">2</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fib</span>(n<span class="hljs-number">-1</span>) + <span class="hljs-built_in">fib</span>(n<span class="hljs-number">-2</span>);
}
</code></pre>
<h2 id="com-laço-de-repetição---on">Com Laço de Repetição - <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</h2>
<p>Essa solução é bem mais rápida que a primeira e é o melhor algoritmo para montar um vetor da sequência de Fibonacci. Porém, ainda é lento para se trabalhar com números muito grandes.</p>
<pre><code class="language-c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">fib</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>
</span>{
    <span class="hljs-type">int</span> a = <span class="hljs-number">0</span>, b = <span class="hljs-number">1</span>, c;

    <span class="hljs-keyword">if</span>( n == <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++)
    {
       c = a + b;
       a = b;
       b = c;
    }
    <span class="hljs-keyword">return</span> b;
}
</code></pre>
<h2 id="exponenciação-de-matriz---ologn">Exponenciação de Matriz - <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(log(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>.</h2>
<p>Essa solução é muito pouco conhecida e se baseia na seguinte propriedade:
elevar a matriz { {1,1} , {1, 0} } no expoente n resulta na matriz { {fib(n+1) ,fib(n)} , {fib(n), fib(n-1)} }.</p>
<pre><code class="language-C++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">mult</span><span class="hljs-params">(ll m[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>], ll m2[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>], ll mod)</span>
</span>{
    ll a = (m[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] * m2[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]) % mod + (m[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] * m2[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]) % mod;
    ll b = (m[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] * m2[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]) % mod + (m[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] * m2[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]) % mod;
    ll c = (m[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] * m2[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]) % mod + (m[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] * m2[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]) % mod;
    ll d = (m[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] * m2[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]) % mod + (m[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] * m2[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]) % mod;

    m[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = a % mod;
    m[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = b % mod;
    m[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = c % mod;
    m[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = d % mod;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getBit_64</span><span class="hljs-params">(ll n, <span class="hljs-type">int</span> shiftLeft)</span>
</span>{
    ll mask = (ll)<span class="hljs-number">1</span> &lt;&lt; shiftLeft;

    <span class="hljs-keyword">if</span>((n &amp; mask) != <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">msb_64</span><span class="hljs-params">(ll n)</span>
</span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">63</span>; i &gt;= <span class="hljs-number">0</span>; i--)
    {
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">getBit_64</span>(n, i) == <span class="hljs-number">1</span>)
            <span class="hljs-keyword">return</span> i;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
}
<span class="hljs-function">ll <span class="hljs-title">fibRapido</span><span class="hljs-params">(ll n, ll mod)</span>
</span>{
    <span class="hljs-keyword">if</span>(n == <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

    <span class="hljs-type">int</span> msbN = <span class="hljs-built_in">msb_64</span>(n);

    ll resp[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = {{<span class="hljs-number">1</span>,<span class="hljs-number">0</span>},{<span class="hljs-number">0</span>,<span class="hljs-number">1</span>}}; <span class="hljs-comment">// matriz identidade</span>
    ll fator[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = {{<span class="hljs-number">1</span>,<span class="hljs-number">1</span>},{<span class="hljs-number">1</span>,<span class="hljs-number">0</span>}};

    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt;= msbN; i++)
    {
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">getBit_64</span>(n, i) == <span class="hljs-number">1</span>)
        {
            <span class="hljs-built_in">mult</span>(resp, fator, mod);
        }

        <span class="hljs-built_in">mult</span>(fator, fator, mod);
    }

    <span class="hljs-keyword">return</span> resp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>];
}
</code></pre>
<p>O algoritmo apresentado retorna a resposta mod m, pois ele serve para trabalhar com números muito grandes, os quais resultam em overflow se não houver operação de módulo envolvida. Ex: fib(1.000.000.000) mod 100. É importante notar que apesar de ele ser muito mais rápido que o algoritmo anterior, ele deve ser utilizado somente quando for imprescindível, posto que demanda muito mais código.</p>
<h2 id="algoritmo-de-fibonacci-fast-doubling">Algoritmo de Fibonacci Fast Doubling</h2>
<p>É a versão simplificada do algoritmo de multiplicação de matriz, evitando contas desnecessárias.</p>
<p>O método Fast Doubling  é baseado nas seguintes duas formulas:</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">[</mo><mn>2</mn><mi>F</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mtext>–</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">F(2n) = F(n)[2F(n+1) – F(n)]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mopen">[</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">–</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)]</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mn>2</mn><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">F(2n + 1) = F(n)2 + F(n+1)2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">2</span></span></span></span></span></p>
<p>Mais informações podem ser vistas <a href="https://www.geeksforgeeks.org/fast-doubling-method-to-find-the-nth-fibonacci-number/#practiceLinkDiv">aqui</a></p>
<pre><code class="language-C++"><span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">fibonatiMod</span> <span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> n,<span class="hljs-type">long</span> <span class="hljs-type">long</span> mod)</span>
</span>{
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> msb_position = <span class="hljs-number">63</span>;
    <span class="hljs-keyword">while</span> (!((<span class="hljs-number">1</span> &lt;&lt; (msb_position<span class="hljs-number">-1</span>) &amp; n)) &amp;&amp; msb_position &gt;= <span class="hljs-number">0</span>)
        msb_position--;
 
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> a=<span class="hljs-number">0</span>, b=<span class="hljs-number">1</span>; 
 
    <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-type">long</span> i=msb_position; i&gt;=<span class="hljs-number">0</span>;--i)
    {       
        <span class="hljs-type">long</span> <span class="hljs-type">long</span> d = (a%mod) * ((b%mod)*<span class="hljs-number">2</span> - (a%mod) + mod),
            e = (a%mod) * (a%mod) + (b%mod)*(b%mod);
        a=d%mod;
        b=e%mod;
 
        <span class="hljs-keyword">if</span> (((n &gt;&gt; i) &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>)
        {
            <span class="hljs-type">long</span> <span class="hljs-type">long</span> c = (a + b) % mod;
            a = b;
            b = c;
        }
    }
    <span class="hljs-keyword">return</span> a;
}
</code></pre>
<h1 id="log-2-o1">Log 2 O(1)</h1>
<h3 id="c">C++</h3>
<pre><code class="language-c++"><span class="hljs-comment">// C++20</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bit&gt;</span></span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">log2_floor</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> i)</span> </span>{
    <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">bit_width</span>(i) - <span class="hljs-number">1</span>;
}

<span class="hljs-comment">// pre C++20</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">log2_floor</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> i)</span> </span>{
    <span class="hljs-keyword">return</span> i ? __builtin_clzll(<span class="hljs-number">1</span>) - __builtin_clzll(i) : <span class="hljs-number">-1</span>;
}
</code></pre>
<h1 id="números-de-catalan">Números de Catalan</h1>
<p>Números de Catalan são usados para resolver alguns problemas de combinatória.</p>
<p>O enésimo número de Catalan (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">C_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) é resultado dos seguintes problemas:</p>
<ul>
<li>Número total de sequências de parênteses corretas (abrindo <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> e fechando <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>). Ex: ()(());</li>
<li>Número de formas para colocar parênteses em <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> fatores.</li>
</ul>
<p><strong>OBS:</strong> Existem MUITAS outras aplicações, mas envolvem assuntos mais complexos.</p>
<pre><code class="language-cpp"><span class="hljs-type">int</span> catalan[maxn];

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">precomputeCatalan</span><span class="hljs-params">()</span>
</span>{
    catalan[<span class="hljs-number">0</span>] = catalan[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= maxn; i++)
    {
        catalan[i] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; i; j++)
        {
            catalan[i] += (catalan[j] * catalan[i-j<span class="hljs-number">-1</span>]) % mod;
            catalan[i] = catalan[i] % mod;
        }
    }
}
</code></pre>
<p>Para acessar <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">C_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, utilizar <code>catalan[n]</code>.</p>
<h1 id="área-de-polígono-fórmula-de-surveyor">Área de Polígono (Fórmula de Surveyor)</h1>
<p>Dados os pontos no plano cartesiano que formam um polígono, pode-se calcular a sua área.</p>
<h2 id="explicação">Explicação</h2>
<p>Para calcular a área, deve-se somar os determinantes dos vetores formados por pontos adjacentes e dividir por 2. Para facilitar
o cálculo, pode-se considerar um polígono de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> lados como uma matriz de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> linhas e 2 colunas (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>). <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> linhas são
necessárias, pois deve-se colocar uma cópia do primeiro ponto no fim da matriz. Deve-se calcular o determinante de todos os pares
de pontos adjacentes, somá-los e dividir por dois. É necessário utilizar o valor absoluto, pois, dependendo da ordem dos pontos (sentido
horário ou anti-horário), o resultado pode ser negativo.</p>
<p><strong>OBS:</strong></p>
<ul>
<li>O polígono não precisa estar centralizado na origem (nem conter a origem);</li>
<li>O polígono não precisa ser convexo;</li>
<li>Os pontos precisam estar &quot;em ordem&quot;, ou seja, no vetor, os pontos vizinhos são adjacentes.</li>
<li>Para o cálculo, é necessário duplicar o primeiro ponto no fim do vetor (a função abaixo já faz isso).</li>
</ul>
<h2 id="o-algoritmo">O Algoritmo</h2>
<p><code>points</code> contém todos os pontos (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>) que formam o polígono &quot;em ordem&quot;.</p>
<pre><code class="language-cpp"><span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">orderedPointsArea</span><span class="hljs-params">(vector&lt;pair&lt;<span class="hljs-type">double</span>, <span class="hljs-type">double</span>&gt;&gt; points)</span>
</span>{
    points.<span class="hljs-built_in">push_back</span>(points.<span class="hljs-built_in">front</span>());

    <span class="hljs-type">double</span> p = <span class="hljs-number">0</span>, n = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; points.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i++)
    {
        p += points[i].first * points[i + <span class="hljs-number">1</span>].second;
        n += points[i].second * points[i + <span class="hljs-number">1</span>].first;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">abs</span>(p - n) / <span class="hljs-number">2</span>;
}
</code></pre>
<h2 id="e-se-os-pontos-não-estiverem-ordenados">E se os pontos não estiverem ordenados?</h2>
<p><strong>Provavelmente</strong>, deve-se aplicar a ordenação dos pontos que é feita no <code>Algoritmo de Graham</code>.</p>
<h1 id="graham-scan">Graham Scan</h1>
<p><em>Jaime Antonio Daniel Filho e Juliano de Mello Pasa</em></p>
<h2 id="o-que-é-um-envoltório-convexo">O que é um envoltório convexo?</h2>
<p>O &quot;convex hull&quot;, como também é conhecido, é definido como o menor polígono convexo que engloba todos os pontos de um certo conjunto. Convexo significa que nenhuma das diagonais do polígono cruza o lado de fora.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/ae0ae734-6ea0-4666-acc4-0134cf519d5a" alt="poligono_convexo_concavo"></p>
<p>Uma das maneiras de visualizar o envoltório convexo é utilizando um elástico de borracha. Para isso, suponha que os pontos são pregos em uma superfície plana. Imagine agora, o que aconteceria se você esticasse um elástico em torno dos pregos e depois o soltasse, permitindo que ele se contraia. O elástico englobaria todos os pregos e encostaria apenas nos mais externos, ou seja, nos que fazem parte do envóltorio convexo.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/2ee1f15e-086e-41e6-9e4d-d5476f6ecebb" alt="analogia_do_elastico"></p>
<h2 id="o-algoritmo-1">O algoritmo</h2>
<p>O Exame de Graham é um dos algoritmos utilizados para encontrar o envóltorio convexo de um conjunto de pontos. O algoritmo computa o subconjunto de pontos pertencentes ao envóltorio junto à ordem em que aparecem.</p>
<p>O primeiro passo é encontrar um ponto que certamente pertence ao envóltorio convexo. O ponto com menor coordenada y, por exemplo, é um deles. Caso mais de um ponto existir nessa mesma coordenada y, escolhemos o com a maior coordenada x. Tal ponto é chamado de P.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/bc455bd2-65b7-4c3a-8c32-be0f4e25b991" alt="algoritmo_parte_1"></p>
<p>Depois, os pontos precisam ser ordenados pelo ângulo que ele forma com o ponto inicial P em relação ao eixo x. Se dois pontos possuírem o mesmo ângulo, ordenamos da maior para menor distância em relação a P.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/99816ad2-f911-4f0d-b380-4239194ae5d3" alt="algoritmo_parte_2"></p>
<p>O algoritmo prossegue percorrendo todos os pontos no vetor ordenado e verificando se ele faz parte ou não do envóltorio convexo. Isso é determinado testando se o ponto atual realiza uma curva no sentido horário ou no sentido anti-horário em relação aos dois pontos anteriores. Caso a curva for no sentido horário, o ponto não pertence ao envóltorio e está dentro do polígono.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/9c9ec097-8273-41c0-b029-367b50066ec1" alt="algoritmo_parte_3"></p>
<p>Os pontos pertencentes ao envóltorio são armazenados em uma pilha. Desse modo, a medida que percorremos o vetor, adicionamos um ponto e, enquanto for necessário girar no sentido horário partindo dos dois últimos pontos, removemos o topo da pilha.</p>
<p>O verdadeiro ângulo entre os pontos não precisa ser calculado para determinar o sentido da curva. Isso pode ser obtido por meio do cálculo do produto vetorial entre os dois vetores. O resultado é um vetor perpendicular com o sentido dado pela regra da mão direita.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/5f35460c-80dd-4069-a3b3-6c7d32e91100" alt="regra_da_mao_direita"></p>
<p>Como os pontos pertencem ao plano xOy, o vetor perpendicular será constituído somente da componente z. Assim, dados três pontos <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_1=(x_1, y_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_1=(x_2, y_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_3=(x_3, y_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, a componente z de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mrow><msub><mi>P</mi><mn>1</mn></msub><msub><mi>P</mi><mn>2</mn></msub></mrow><mo>⃗</mo></mover><mo>×</mo><mover accent="true"><mrow><msub><mi>P</mi><mn>1</mn></msub><msub><mi>P</mi><mn>3</mn></msub></mrow><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{P_1P_2}\times\vec{P_1P_3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1163em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1163em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span> é calculada pela expressão <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>3</mn></msub><mo>−</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>2</mn></msub><mo>−</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>3</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_2 - x_1)(y_3 - y_1) - (y_2 - y_1)(x_3 - x_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. Se o resultado for igual a 0, os pontos são colineares. Se for positivo, os três pontos formam uma curva no sentido anti-horário. Se for negativo, estão no sentido horário.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/dfb81982-cdd6-4b61-9639-451a268d23b7" alt="algoritmo_parte_4"></p>
<p>Exemplo de excução do algoritmo com posição dos pontos na pilha. O ponto <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> é o ponto atual do vetor sendo analisado. Os pontos <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">2</span></span></span></span> correspondem ao ponto no topo da pilha e o ponto logo abaixo (notação de índices em Python). Os pontos em <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> vermelho são os pontos excluídos do polígono. As linhas verdes são arestas que farão parte do polígono convexo. As linhas azuis são as arestas que estão sendo analisadas, enquanto as linhas vermelhas são linhas que podem ser removidas. As linhas vermelhas serão removidas caso os pontos analisados não forme uma curva no sentido anti-horário.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/06bf62cc-9cf2-402c-ae7a-a9869c3e43e6" alt="executionGif"></p>
<h2 id="implementação-c">Implementação C++</h2>
<pre><code class="language-cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Point</span>
{
    <span class="hljs-type">int</span> x;
    <span class="hljs-type">int</span> y;
};

<span class="hljs-comment">// Calcula a distância euclidiana entre dois pontos.</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">distance_squared</span><span class="hljs-params">(<span class="hljs-type">const</span> Point &amp;a, <span class="hljs-type">const</span> Point &amp;b)</span>
</span>{
    <span class="hljs-type">int</span> dx = a.x - b.x;i
    <span class="hljs-type">int</span> dy = a.y - b.y;

    <span class="hljs-keyword">return</span> dx * dx + dy * dy;
}

<span class="hljs-comment">// Calculate o produto vetorial entre AB e AC:</span>
<span class="hljs-comment">// AB x AC = 0 -&gt; colinear</span>
<span class="hljs-comment">// AB x AC &gt; 0 -&gt; anti-horário</span>
<span class="hljs-comment">// AB x AC &lt; 0 -&gt; horário</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">cross_product</span><span class="hljs-params">(<span class="hljs-type">const</span> Point &amp;a, <span class="hljs-type">const</span> Point &amp;b, <span class="hljs-type">const</span> Point &amp;c)</span>
</span>{
    <span class="hljs-keyword">return</span> (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x);
}

<span class="hljs-comment">// ALgoritmo de Graham Scan para encontrar o menor envoltório convexo.</span>
<span class="hljs-function">std::vector&lt;Point&gt; <span class="hljs-title">graham_scan</span><span class="hljs-params">(std::vector&lt;Point&gt; &amp;points)</span>
</span>{
    <span class="hljs-comment">// Se existirem 3 pontos, o menor envoltório convexo é formado por eles.</span>
    <span class="hljs-keyword">if</span> (points.<span class="hljs-built_in">size</span>() &lt;= <span class="hljs-number">3</span>)
    {
        <span class="hljs-keyword">return</span> points;
    }

    <span class="hljs-comment">// Vetor que armazena os pontos que formam o envoltório convexo.</span>
    std::vector&lt;Point&gt; hull;

    <span class="hljs-comment">// Inicia P0 com o primeiro ponto do vetor.</span>
    Point p0 = points[<span class="hljs-number">0</span>];

    <span class="hljs-comment">// Encontra o ponto mais baixo e mais à direita.</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">1</span>; i &lt; points.<span class="hljs-built_in">size</span>(); i++)
    {
        <span class="hljs-keyword">if</span> (points[i].y &lt; p0.y || (points[i].y == p0.y &amp;&amp; points[i].x &gt; p0.x))
        {
            p0 = points[i];
        }
    }

    <span class="hljs-comment">// Ordena os pontos de acordo com o ângulo que eles formam com P0.</span>
    <span class="hljs-comment">// Isto é, de modo que eles sempre estejam no sentido anti-horário</span>
    <span class="hljs-comment">// em relação a P0.</span>
    std::<span class="hljs-built_in">sort</span>(points.<span class="hljs-built_in">begin</span>(), points.<span class="hljs-built_in">end</span>(), [&amp;](Point &amp;a, Point &amp;b) {
        <span class="hljs-type">int</span> product = <span class="hljs-built_in">cross_product</span>(p0, a, b);

        <span class="hljs-keyword">if</span> (product != <span class="hljs-number">0</span>)
        {
            <span class="hljs-comment">// Se o produto for positivo, o ponto mais à direita é o A, pois</span>
            <span class="hljs-comment">// giramos no sentido anti-horário partindo de A para chegarmos em B.</span>
            <span class="hljs-keyword">return</span> product &gt; <span class="hljs-number">0</span>;
        }

        <span class="hljs-type">int</span> distance_b = <span class="hljs-built_in">distance_squared</span>(p0, b);
        <span class="hljs-type">int</span> distance_a = <span class="hljs-built_in">distance_squared</span>(p0, a);

        <span class="hljs-comment">// Se os pontos forem colineares, o mais distante de P0 vem primeiro.</span>
        <span class="hljs-keyword">return</span> distance_a &lt; distance_b;
    });

    <span class="hljs-comment">// Percorre e verifica o restante do vetor de pontos.</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; points.<span class="hljs-built_in">size</span>(); i++)
    {
        <span class="hljs-comment">// Enquanto ponto atual e os dois últimos pontos no envoltório</span>
        <span class="hljs-comment">// formarem um ângulo horário, remova o ponto do topo do envoltório.</span>
        <span class="hljs-keyword">while</span> (hull.<span class="hljs-built_in">size</span>() &gt;= <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-built_in">cross_product</span>(hull[hull.<span class="hljs-built_in">size</span>() - <span class="hljs-number">2</span>], hull[hull.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>], points[i]) &lt;= <span class="hljs-number">0</span>)
        {
            hull.<span class="hljs-built_in">pop_back</span>();
        }

        <span class="hljs-comment">// Adiciona o ponto ao envoltório convexo.</span>
        hull.<span class="hljs-built_in">push_back</span>(points[i]);
    }

    <span class="hljs-keyword">return</span> hull;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    std::vector&lt;Point&gt; points = {
    };

    std::vector&lt;Point&gt; hull = <span class="hljs-built_in">graham_scan</span>(points);

    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> Point &amp;point : hull)
    {
        std::cout &lt;&lt; <span class="hljs-string">&quot;(&quot;</span> &lt;&lt; point.x &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; point.y &lt;&lt; <span class="hljs-string">&quot;)&quot;</span> &lt;&lt; std::endl;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="outra-forma-de-calcular-orientação">Outra forma de calcular orientação</h2>
<p>Na implementação em Python, a orientação foi calculada de uma forma diferente. Em vez de utilizar o produto vetorial entre os dois vetores formados pelos 3 pontos, foi calculada a diferença entre suas subidas. As operações são idênticas, mas as componentes multiplicadas são diferentes. Em decorrência disso, para pontos no sentido anti-horário, o valor será negativo, enquanto para pontos no senti horário o valor será positivo.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/ca2fd619-5cf5-426e-8798-dc4c99368588" alt="desmos-graph (0)"></p>
<h2 id="implementação-python">Implementação Python</h2>
<pre><code class="language-python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> cmp_to_key


<span class="hljs-comment"># Calcula a orientacao de 3 pontos com base na diferença entre suas subidas.</span>
<span class="hljs-comment"># Essa funcao eh usada no ordenamento e no scan.</span>
<span class="hljs-comment"># A orientacao eh dada da seguinte forma:</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment">#   valor &lt; 0: os pontos estao no sentido anti-horario</span>
<span class="hljs-comment">#   valor = 0: os pontos sao colineares</span>
<span class="hljs-comment">#   valor &gt; 0: os pontos estao no sentido horario</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">CalculateOrientation</span>(<span class="hljs-params">p1, p2, p3</span>):
    <span class="hljs-keyword">return</span> (p2[<span class="hljs-number">1</span>] - p1[<span class="hljs-number">1</span>]) * (p3[<span class="hljs-number">0</span>] - p2[<span class="hljs-number">0</span>]) - (p3[<span class="hljs-number">1</span>] - p2[<span class="hljs-number">1</span>]) * (p2[<span class="hljs-number">0</span>] - p1[<span class="hljs-number">0</span>])


<span class="hljs-comment"># Calcula o quadrado da distancia entre dois pontos.</span>
<span class="hljs-comment"># Essa funcao eh usada no ordenamento.</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">CalculateSquaredDistance</span>(<span class="hljs-params">p1, p2</span>):
    <span class="hljs-keyword">return</span> (p2[<span class="hljs-number">0</span>] - p1[<span class="hljs-number">0</span>])**<span class="hljs-number">2</span> + (p2[<span class="hljs-number">1</span>] - p1[<span class="hljs-number">1</span>])**<span class="hljs-number">2</span>


<span class="hljs-comment"># Funcao de comparacao que sera utilizada pelo sorted() do python.</span>
<span class="hljs-comment"># Funcoes de comparacao devem retornar valores inteiros da seguinte forma:</span>
<span class="hljs-comment"># </span>
<span class="hljs-comment">#   valor &lt; 0: p1 vem antes de p2  </span>
<span class="hljs-comment">#   valor = 0: p1 eh igual p2</span>
<span class="hljs-comment">#   valor &gt; 0: p1 vem depois de p2</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># No caso do scan de Graham, pontos com orientacao anti-horaria devem ser os primeiros da lista,</span>
<span class="hljs-comment"># entao basta retornar o valor da orientacao, pois a orientacao anti-horaria tem valor negativo.</span>
<span class="hljs-comment"># Caso a orientacao seja igual a zero, o ponto mais proximo do ponto inicial deve vir primeiro.</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">CompareOrientation</span>(<span class="hljs-params">p1, p2</span>):
    orientation = CalculateOrientation(startingPoint, p1, p2)

    <span class="hljs-keyword">if</span> orientation: 
        <span class="hljs-keyword">return</span> orientation
    <span class="hljs-keyword">if</span> CalculateSquaredDistance(startingPoint, p1) &lt;= CalculateSquaredDistance(startingPoint, p2):
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
    n = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())
    points = []

    <span class="hljs-keyword">assert</span> n &gt; <span class="hljs-number">2</span>, <span class="hljs-string">&quot;Nao e possivel montar um poligono com menos de 3 pontos&quot;</span>

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
        points.append(<span class="hljs-built_in">tuple</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split(<span class="hljs-string">&quot; &quot;</span>))))

    <span class="hljs-comment"># Esse ponto deve ser global pois ele eh utilizado na funcao de comparacao do sorted().</span>
    <span class="hljs-comment"># A funcao de comparacao recebe apenas dois valores (os valores que estao sendo comparados), </span>
    <span class="hljs-comment"># e por isso nao eh possivel passar o startingPoint como terceiro parametro.</span>
    <span class="hljs-keyword">global</span> startingPoint
    startingPoint = points[<span class="hljs-number">0</span>]

    <span class="hljs-comment"># Laco para encontrar o ponto com o menor Y.</span>
    <span class="hljs-comment"># Se dois pontos tiverem o mesmo Y, eh selecionado o mais a esquerda</span>
    <span class="hljs-comment"># Complexidade: O(n)</span>
    <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> points:
        <span class="hljs-keyword">if</span> r[<span class="hljs-number">1</span>] &lt; startingPoint[<span class="hljs-number">1</span>]:
            startingPoint = r
        <span class="hljs-keyword">elif</span> r[<span class="hljs-number">1</span>] == startingPoint[<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> r[<span class="hljs-number">0</span>] &lt; startingPoint[<span class="hljs-number">0</span>]:
            startingPoint = r

    <span class="hljs-comment"># Ordenacao dos pontos com base no angulo com o startingPoint</span>
    <span class="hljs-comment"># key=cmp_to_key() eh utilizado para alterar a funcao de comparacao</span>
    <span class="hljs-comment"># entre dois valores da estrutura</span>
    <span class="hljs-comment"># Complexidade: O(nLogN)</span>
    points = <span class="hljs-built_in">sorted</span>(points, key=cmp_to_key(CompareOrientation))

    <span class="hljs-comment"># O ponto inicial sempre fara parte do fecho convexo</span>
    filteredPoints = [startingPoint]

    <span class="hljs-comment"># Nessa etapa do algoritmo, sao removidos os pontos colineares</span>
    <span class="hljs-comment"># e mantidos somente o ponto mais distante.</span>
    <span class="hljs-comment"># Caso um ponto nao seja colinear com o proximo ponto, entao ele </span>
    <span class="hljs-comment"># eh o ponto mais distante do startingPoint com aquele angulo</span>
    <span class="hljs-comment"># Complexidade: O(n)</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(points) - <span class="hljs-number">1</span>):
        <span class="hljs-keyword">if</span> CalculateOrientation(startingPoint, points[i], points[i+<span class="hljs-number">1</span>]):
            filteredPoints.append(points[i])
    filteredPoints.append(points[-<span class="hljs-number">1</span>])

    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(filteredPoints) &gt; <span class="hljs-number">2</span>, <span class="hljs-string">&quot;Nao ha mais de 2 pontos nao colineares entre si&quot;</span>

    <span class="hljs-comment"># A etapa final do algoritmo eh o scan em si.</span>
    <span class="hljs-comment"># Os pontos que fazem parte do fecho sao guardados em uma pilha.</span>

    <span class="hljs-comment"># A pilha eh iniciada com os 3 primeiros pontos filtrados.</span>
    resultStack = [startingPoint, filteredPoints[<span class="hljs-number">1</span>], filteredPoints[<span class="hljs-number">2</span>]]

    <span class="hljs-comment"># Para cada ponto p restante, eh verificada sua orientacao com o ultimo</span>
    <span class="hljs-comment"># e o penultimo ponto da pilha. Se esses 3 pontos forem colineares ou de</span>
    <span class="hljs-comment"># orientacao horaria, significa que o ultimo ponto da pilha nao faz parte</span>
    <span class="hljs-comment"># do fecho, e entao ele eh removido. Agora, o ponto p sera comparado com os</span>
    <span class="hljs-comment"># novos ultimo e penultimo pontos.</span>
    <span class="hljs-comment"># Caso o ponto p tenha uma orientacao anti-horária, ele eh adicionado ao topo da pilha</span>
    <span class="hljs-comment"># Complexidade: O(n)</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> filteredPoints[<span class="hljs-number">3</span>:]:
        <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(resultStack) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> CalculateOrientation(resultStack[-<span class="hljs-number">2</span>], resultStack[-<span class="hljs-number">1</span>], p) &gt;= <span class="hljs-number">0</span>:
            resultStack.pop()
        resultStack.append(p)

    <span class="hljs-built_in">print</span>(resultStack)
</code></pre>
<h2 id="grande-tratado-da-bytelândia">Grande Tratado da Bytelândia</h2>
<p>A Grande Guerra da Bytelândia chegou ao fim. Os reinos restantes agora estão discutindo o Tratado
de Divisão, que dividirá todas as terras do mundo entre eles. Este tratado se refere não apenas ao
mundo conhecido, mas também a quaisquer territórios ainda não descobertos ou habitados, incluindo
terra ou mar. Podemos assumir que o mundo é um plano infinito.</p>
<p>Cada reino no continente da Bytelândia tem uma única capital, e o Tratado de Divisão será baseado
em suas localiza¸cões: ele declara que cada pedaço de terra pertence ao reino cuja capital é a mais
próxima em um voo de pássaro (ou em linha reta). Em outras palavras: onde quer que você esteja no
mundo, se <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> é a capital mais próxima de você, você estará no território do reino de C. Se houver um
empate entre as distâncias de duas ou mais capitais, esse lugar estará na fronteira entre seus reinos.</p>
<p>Sob este tratado, alguns reinos podem ficar cercados por outros, enquanto outros reinos podem
ficar com território ilimitado. Por isso, alguns monarcas estão contestando o tratado. Para informar
essa discussão, eles exigem sua ajuda. Dadas as coordenadas das localizações de cada capital no
continente da Bytelândia, você deve descobrir quais reinos teriam territórios infinitos sob o Tratado
de Divisão.</p>
<h3 id="entrada">Entrada</h3>
<p>A primeira linha da entrada contém um único inteiro <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>2</mn><mo>≤</mo><mi>N</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N (2 ≤ N ≤ 10^5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, o número de reinos.
Cada reino é identificado por um número inteiro único entre 1 e N. Cada uma das N linhas seguintes
contém dois inteiros <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>≤</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0 ≤ X, Y ≤ 10^4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, as coordenadas 2D da localização da capital de um
reino. As capitais são dadas em ordem crescente de identificador do reino, não há duas capitais com
a mesma localização, e você pode assumir que toda capital tem tamanho insignificante.</p>
<h3 id="saída">Saída</h3>
<p>Imprima uma única linha com uma lista de inteiros separados por espaço em ordem crescente:
os identificadores dos reinos que teriam territórios infinitos sob o Tratado de Divisão descrito. É
garantido que sempre haverá pelo menos um reino assim.</p>
<hr>
<p>O problema fornece uma série de reinos, representados por pontos, e quer descobrir quais deles possuem terrenos infinitos. Utilizando o Diagrama de Voronoy, uma forma de decomposição que divide o espaço em áreas mais próximas a determinado pontos, podemos fácilmente visualizar o problema.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/16589959-2bc6-4a85-b324-f90f1ef7e2ad" alt="voronoy"></p>
<p>Com o desenho dos pontos, é possível perceber que os reinos com terrenos infinitos são aqueles que fazem parte do envóltorio convexo. Entretanto, torna-se necessário realizar algumas adaptações no algoritmo de Graham Scan, pois, diferentemente do problema original, precisamos considerar também os pontos que estão na borda do envoltório, mas não são vértices do menor polígono.</p>
<p>O primeiro passo, então, é modificar o nosso algoritmo para que ele não remova pontos colineares, isto é, os pontos em que o produto vetorial seja igual a 0.</p>
<h3 id="c-1">C++</h3>
<pre><code class="language-cpp">        <span class="hljs-comment">// Modificamos a regra para remover os pontos apenas no sentido horário, ou seja, apenas</span>
        <span class="hljs-comment">// os que o produto vetorial for negativo (&lt; 0).</span>
        <span class="hljs-keyword">while</span> (hull.<span class="hljs-built_in">size</span>() &gt;= <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-built_in">cross_product</span>(hull[hull.<span class="hljs-built_in">size</span>() - <span class="hljs-number">2</span>], hull[hull.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>], points[i]) &lt; <span class="hljs-number">0</span>)
        {
            hull.<span class="hljs-built_in">pop_back</span>();
        }
</code></pre>
<h3 id="python">Python</h3>
<pre><code class="language-python">        <span class="hljs-comment"># O trecho que remove os pontos colineares deve ser removido da implementação</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(points) - <span class="hljs-number">1</span>):
            <span class="hljs-keyword">if</span> CalculateOrientation(startingPoint, points[i], points[i+<span class="hljs-number">1</span>]):
                filteredPoints.append(points[i])
        filteredPoints.append(points[-<span class="hljs-number">1</span>])

        <span class="hljs-comment"># O trecho do scan deve ser modificado, para remover somente os pontos no sentido horário, ou seja,</span>
        <span class="hljs-comment"># apenas os que a diferença entre a subida seja positiva (&gt; 0).</span>
        <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(resultStack) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> CalculateOrientation(resultStack[-<span class="hljs-number">2</span>], resultStack[-<span class="hljs-number">1</span>], p) &gt; <span class="hljs-number">0</span>:
            resultStack.pop()
</code></pre>
<p>Isso, porém, gera um pequeno problema. Quando os pontos possuírem o mesmo ângulo com o ponto inicial P, o algoritmo verificará os pontos do mais próximo para o mais distante pelas nossas regras de ordenação. Entretanto, caso esse pontos sejam os últimos, a curva realizada quando partirmos para o ponto seguinte será no sentido horário e o ponto anterior será removido.</p>
<p><img src="https://github.com/jaimeadf/Material-da-Maratona/assets/40345645/ece6be0a-7a55-4b28-a9be-93d42370a3d6" alt="colineares"></p>
<p><em>O algoritmo verifica inicialmente o ponto F e, quando parte para o ponto E, uma curva horária é formada e o F removido. Os polígono resultante será ABCDE.</em></p>
<p>A solução para esse caso é reverter a ordem dos pontos colineares com maior ângulo para que eles sejam verificados da maior para a menor distância.</p>
<pre><code class="language-cpp">    std::<span class="hljs-built_in">sort</span>(...);

    <span class="hljs-type">size_t</span> colinear_index = points.<span class="hljs-built_in">size</span>() - <span class="hljs-number">2</span>;

    <span class="hljs-comment">// Encontra os últimos pontos colineares em relação a P0.</span>
    <span class="hljs-keyword">while</span> (colinear_index &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">cross_product</span>(p0, points.<span class="hljs-built_in">back</span>(), points[colinear_index]) == <span class="hljs-number">0</span>)
    {
        colinear_index--;
    }

    <span class="hljs-comment">// Inverte os pontos colineares para serem ordenados da maior para a menor distância.</span>
    std::<span class="hljs-built_in">reverse</span>(points.<span class="hljs-built_in">begin</span>() + colinear_index + <span class="hljs-number">1</span>, points.<span class="hljs-built_in">end</span>());
</code></pre>
<p>Outra solução para tratar os últimos pontos colineares é verificar se há mais pontos colineares entre o ponto inicial e o último ponto do polígono convexo. Caso haja mais pontos colineares (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>a</mi><mi>l</mi><mi>c</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>O</mi><mi>r</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">CalculateOrientation == 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">==</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>), eles serão adicionados em um vetor. Esse vetor só será adicionado à pilha final caso existam outros pontos no polígono que não são colineares entre o último ponto e o ponto inicial. Essa extensão dos pontos resultantes deve seguir essa regra para evitar que os pontos sejam reinseridos caso o polígono inicialmente calculado seja composto somente de pontos colineares (os primeiros pontos calculados).</p>
<pre><code class="language-python">    lastCollinear = []

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(reinos) - <span class="hljs-number">2</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> CalculateOrientation(resultStack[-<span class="hljs-number">1</span>], reinos[-<span class="hljs-number">2</span>-i], start):
            lastCollinear.append(reinos[-<span class="hljs-number">2</span>-i])
        <span class="hljs-keyword">else</span>:
            resultStack.extend(lastCollinear)
            <span class="hljs-keyword">break</span>
</code></pre>
<p>Por fim, adicionamos a leitura das entradas e imprimimos os pontos ordenados por um campo identificador.</p>
<h2 id="c-2">C++</h2>
<pre><code class="language-cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Point</span>
{
    <span class="hljs-type">int</span> id;

    <span class="hljs-type">int</span> x;
    <span class="hljs-type">int</span> y;
};

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">distance_squared</span><span class="hljs-params">(<span class="hljs-type">const</span> Point &amp;a, <span class="hljs-type">const</span> Point &amp;b)</span>
</span>{
    <span class="hljs-type">int</span> dx = a.x - b.x;
    <span class="hljs-type">int</span> dy = a.y - b.y;

    <span class="hljs-keyword">return</span> dx * dx + dy * dy;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">cross_product</span><span class="hljs-params">(<span class="hljs-type">const</span> Point &amp;a, <span class="hljs-type">const</span> Point &amp;b, <span class="hljs-type">const</span> Point &amp;c)</span>
</span>{
    <span class="hljs-keyword">return</span> (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x);
}

<span class="hljs-function">std::vector&lt;Point&gt; <span class="hljs-title">graham_scan</span><span class="hljs-params">(std::vector&lt;Point&gt; &amp;points)</span>
</span>{
    <span class="hljs-keyword">if</span> (points.<span class="hljs-built_in">size</span>() &lt;= <span class="hljs-number">3</span>)
    {
        <span class="hljs-keyword">return</span> points;
    }

    std::vector&lt;Point&gt; hull;

    Point p0 = points[<span class="hljs-number">0</span>];

    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">1</span>; i &lt; points.<span class="hljs-built_in">size</span>(); i++)
    {
        <span class="hljs-keyword">if</span> (points[i].y &lt; p0.y || (points[i].y == p0.y &amp;&amp; points[i].x &gt; p0.x))
        {
            p0 = points[i];
        }
    }

    std::<span class="hljs-built_in">sort</span>(points.<span class="hljs-built_in">begin</span>(), points.<span class="hljs-built_in">end</span>(), [&amp;](Point &amp;a, Point &amp;b) {
        <span class="hljs-type">int</span> product = <span class="hljs-built_in">cross_product</span>(p0, a, b);

        <span class="hljs-keyword">if</span> (product != <span class="hljs-number">0</span>)
        {
            <span class="hljs-keyword">return</span> product &gt; <span class="hljs-number">0</span>;
        }

        <span class="hljs-type">int</span> distance_b = <span class="hljs-built_in">distance_squared</span>(p0, b);
        <span class="hljs-type">int</span> distance_a = <span class="hljs-built_in">distance_squared</span>(p0, a);

        <span class="hljs-keyword">return</span> distance_a &lt; distance_b;
    });

    <span class="hljs-type">size_t</span> colinear_index = points.<span class="hljs-built_in">size</span>() - <span class="hljs-number">2</span>;
    <span class="hljs-keyword">while</span> (colinear_index &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">cross_product</span>(p0, points.<span class="hljs-built_in">back</span>(), points[colinear_index]) == <span class="hljs-number">0</span>)
    {
        colinear_index--;
    }

    std::<span class="hljs-built_in">reverse</span>(points.<span class="hljs-built_in">begin</span>() + colinear_index + <span class="hljs-number">1</span>, points.<span class="hljs-built_in">end</span>());

    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; points.<span class="hljs-built_in">size</span>(); i++)
    {
        <span class="hljs-keyword">while</span> (hull.<span class="hljs-built_in">size</span>() &gt;= <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-built_in">cross_product</span>(hull[hull.<span class="hljs-built_in">size</span>() - <span class="hljs-number">2</span>], hull[hull.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>], points[i]) &lt; <span class="hljs-number">0</span>)
        {
            hull.<span class="hljs-built_in">pop_back</span>();
        }

        hull.<span class="hljs-built_in">push_back</span>(points[i]);
    }

    <span class="hljs-keyword">return</span> hull;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    std::ios_base::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);

    <span class="hljs-type">size_t</span> length;
    std::cin &gt;&gt; length;

    <span class="hljs-function">std::vector&lt;Point&gt; <span class="hljs-title">kingdoms</span><span class="hljs-params">(length)</span></span>;    
    
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; length; i++)
    {
        kingdoms[i].id = i + <span class="hljs-number">1</span>;
        std::cin &gt;&gt; kingdoms[i].x &gt;&gt; kingdoms[i].y;
    }

    std::vector&lt;Point&gt; hull = <span class="hljs-built_in">graham_scan</span>(kingdoms);

    std::<span class="hljs-built_in">sort</span>(hull.<span class="hljs-built_in">begin</span>(), hull.<span class="hljs-built_in">end</span>(), [&amp;](Point &amp;a, Point &amp;b) {
        <span class="hljs-keyword">return</span> a.id &lt; b.id;
    });

    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> Point &amp;point : hull)
    {
        std::cout &lt;&lt; point.id &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 id="python-1">Python</h2>
<pre><code class="language-python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> cmp_to_key


<span class="hljs-keyword">def</span> <span class="hljs-title function_">CalculateOrientation</span>(<span class="hljs-params">p1, p2, p3</span>):
    <span class="hljs-keyword">return</span> (p2[<span class="hljs-number">1</span>] - p1[<span class="hljs-number">1</span>]) * (p3[<span class="hljs-number">0</span>] - p2[<span class="hljs-number">0</span>]) - (p3[<span class="hljs-number">1</span>] - p2[<span class="hljs-number">1</span>]) * (p2[<span class="hljs-number">0</span>] - p1[<span class="hljs-number">0</span>])

<span class="hljs-keyword">def</span> <span class="hljs-title function_">CalculateSquaredDistance</span>(<span class="hljs-params">p1, p2</span>):
    <span class="hljs-keyword">return</span> (p2[<span class="hljs-number">0</span>] - p1[<span class="hljs-number">0</span>])**<span class="hljs-number">2</span> + (p2[<span class="hljs-number">1</span>] - p1[<span class="hljs-number">1</span>])**<span class="hljs-number">2</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">CompareOrientation</span>(<span class="hljs-params">p1, p2</span>):
    orientation = CalculateOrientation(start, p1, p2)

    <span class="hljs-keyword">if</span> orientation: 
        <span class="hljs-keyword">return</span> orientation
    <span class="hljs-keyword">if</span> CalculateSquaredDistance(start, p1) &lt;= CalculateSquaredDistance(start, p2):
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>


n = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())
reinos = []

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
    info = <span class="hljs-built_in">input</span>().split(<span class="hljs-string">&quot; &quot;</span>)
    info.append(i+<span class="hljs-number">1</span>)
    reinos.append(<span class="hljs-built_in">tuple</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, info)))

<span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">4</span>:
    output = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> reinos:
        output += <span class="hljs-built_in">str</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">{r[<span class="hljs-number">2</span>]}</span> &quot;</span>)

    <span class="hljs-built_in">print</span>(output[:-<span class="hljs-number">1</span>])
    quit()

start = reinos[<span class="hljs-number">0</span>]

<span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> reinos:
    <span class="hljs-keyword">if</span> r[<span class="hljs-number">1</span>] &lt; start[<span class="hljs-number">1</span>]:
        start = r
    <span class="hljs-keyword">elif</span> r[<span class="hljs-number">1</span>] == start[<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> r[<span class="hljs-number">0</span>] &lt; start[<span class="hljs-number">0</span>]:
        start = r

reinos = <span class="hljs-built_in">sorted</span>(reinos, key=cmp_to_key(CompareOrientation))
resultStack = [start, reinos[<span class="hljs-number">1</span>], reinos[<span class="hljs-number">2</span>]]

<span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> reinos[<span class="hljs-number">3</span>:]:
    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(resultStack) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> CalculateOrientation(resultStack[-<span class="hljs-number">2</span>], resultStack[-<span class="hljs-number">1</span>], p) &gt; <span class="hljs-number">0</span>:
        resultStack.pop()
    resultStack.append(p)

lastCollinear = []

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(reinos) - <span class="hljs-number">2</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> CalculateOrientation(resultStack[-<span class="hljs-number">1</span>], reinos[-<span class="hljs-number">2</span>-i], start):
        lastCollinear.append(reinos[-<span class="hljs-number">2</span>-i])
    <span class="hljs-keyword">else</span>:
        resultStack.extend(lastCollinear)
        <span class="hljs-keyword">break</span>

resultStack.sort(key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">2</span>])
output = <span class="hljs-string">&quot;&quot;</span>
<span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> resultStack:
    output += <span class="hljs-built_in">str</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">{r[<span class="hljs-number">2</span>]}</span> &quot;</span>)

<span class="hljs-built_in">print</span>(output[:-<span class="hljs-number">1</span>])
</code></pre>
<h1 id="material-sobre-interseccoes">Material sobre interseccoes</h1>
<h2 id="codigo-para-checar-se-um-ponto-esta-em-um-poligono-convexo">Codigo para checar se um ponto esta em um poligono convexo</h2>
<p>Nao entendi, mas coloquei aqui.</p>
<pre><code class="language-cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">pt</span> {
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> x, y;
    <span class="hljs-built_in">pt</span>() {}
    <span class="hljs-built_in">pt</span>(<span class="hljs-type">long</span> <span class="hljs-type">long</span> _x, <span class="hljs-type">long</span> <span class="hljs-type">long</span> _y) : <span class="hljs-built_in">x</span>(_x), <span class="hljs-built_in">y</span>(_y) {}
    pt <span class="hljs-keyword">operator</span>+(<span class="hljs-type">const</span> pt &amp;p) <span class="hljs-type">const</span> { <span class="hljs-keyword">return</span> <span class="hljs-built_in">pt</span>(x + p.x, y + p.y); }
    pt <span class="hljs-keyword">operator</span>-(<span class="hljs-type">const</span> pt &amp;p) <span class="hljs-type">const</span> { <span class="hljs-keyword">return</span> <span class="hljs-built_in">pt</span>(x - p.x, y - p.y); }
    <span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">cross</span><span class="hljs-params">(<span class="hljs-type">const</span> pt &amp;p)</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> x * p.y - y * p.x; }
    <span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">dot</span><span class="hljs-params">(<span class="hljs-type">const</span> pt &amp;p)</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> x * p.x + y * p.y; }
    <span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">cross</span><span class="hljs-params">(<span class="hljs-type">const</span> pt &amp;a, <span class="hljs-type">const</span> pt &amp;b)</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> (a - *<span class="hljs-keyword">this</span>).<span class="hljs-built_in">cross</span>(b - *<span class="hljs-keyword">this</span>); }
    <span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">dot</span><span class="hljs-params">(<span class="hljs-type">const</span> pt &amp;a, <span class="hljs-type">const</span> pt &amp;b)</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> (a - *<span class="hljs-keyword">this</span>).<span class="hljs-built_in">dot</span>(b - *<span class="hljs-keyword">this</span>); }
    <span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-type">long</span> <span class="hljs-title">sqrLen</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">dot</span>(*<span class="hljs-keyword">this</span>); }
};

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">lexComp</span><span class="hljs-params">(<span class="hljs-type">const</span> pt &amp;l, <span class="hljs-type">const</span> pt &amp;r)</span> </span>{
    <span class="hljs-keyword">return</span> l.x &lt; r.x || (l.x == r.x &amp;&amp; l.y &lt; r.y);
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">sgn</span><span class="hljs-params">(<span class="hljs-type">long</span> <span class="hljs-type">long</span> val)</span> </span>{ <span class="hljs-keyword">return</span> val &gt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : (val == <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : <span class="hljs-number">-1</span>); }

vector&lt;pt&gt; seq;
pt translation;
<span class="hljs-type">int</span> n;

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">pointInTriangle</span><span class="hljs-params">(pt a, pt b, pt c, pt point)</span> </span>{
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> s1 = <span class="hljs-built_in">abs</span>(a.<span class="hljs-built_in">cross</span>(b, c));
    <span class="hljs-type">long</span> <span class="hljs-type">long</span> s2 = <span class="hljs-built_in">abs</span>(point.<span class="hljs-built_in">cross</span>(a, b)) + <span class="hljs-built_in">abs</span>(point.<span class="hljs-built_in">cross</span>(b, c)) + <span class="hljs-built_in">abs</span>(point.<span class="hljs-built_in">cross</span>(c, a));
    <span class="hljs-keyword">return</span> s1 == s2;
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">prepare</span><span class="hljs-params">(vector&lt;pt&gt; &amp;points)</span> </span>{
    n = points.<span class="hljs-built_in">size</span>();
    <span class="hljs-type">int</span> pos = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i++) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">lexComp</span>(points[i], points[pos]))
            pos = i;
    }
    <span class="hljs-built_in">rotate</span>(points.<span class="hljs-built_in">begin</span>(), points.<span class="hljs-built_in">begin</span>() + pos, points.<span class="hljs-built_in">end</span>());

    n--;
    seq.<span class="hljs-built_in">resize</span>(n);
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)
        seq[i] = points[i + <span class="hljs-number">1</span>] - points[<span class="hljs-number">0</span>];
    translation = points[<span class="hljs-number">0</span>];
}

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">pointInConvexPolygon</span><span class="hljs-params">(pt point)</span> </span>{
    point = point - translation;
    <span class="hljs-keyword">if</span> (seq[<span class="hljs-number">0</span>].<span class="hljs-built_in">cross</span>(point) != <span class="hljs-number">0</span> &amp;&amp;
            <span class="hljs-built_in">sgn</span>(seq[<span class="hljs-number">0</span>].<span class="hljs-built_in">cross</span>(point)) != <span class="hljs-built_in">sgn</span>(seq[<span class="hljs-number">0</span>].<span class="hljs-built_in">cross</span>(seq[n - <span class="hljs-number">1</span>])))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (seq[n - <span class="hljs-number">1</span>].<span class="hljs-built_in">cross</span>(point) != <span class="hljs-number">0</span> &amp;&amp;
            <span class="hljs-built_in">sgn</span>(seq[n - <span class="hljs-number">1</span>].<span class="hljs-built_in">cross</span>(point)) != <span class="hljs-built_in">sgn</span>(seq[n - <span class="hljs-number">1</span>].<span class="hljs-built_in">cross</span>(seq[<span class="hljs-number">0</span>])))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">if</span> (seq[<span class="hljs-number">0</span>].<span class="hljs-built_in">cross</span>(point) == <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> seq[<span class="hljs-number">0</span>].<span class="hljs-built_in">sqrLen</span>() &gt;= point.<span class="hljs-built_in">sqrLen</span>();

    <span class="hljs-type">int</span> l = <span class="hljs-number">0</span>, r = n - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> (r - l &gt; <span class="hljs-number">1</span>) {
        <span class="hljs-type">int</span> mid = (l + r) / <span class="hljs-number">2</span>;
        <span class="hljs-type">int</span> pos = mid;
        <span class="hljs-keyword">if</span> (seq[pos].<span class="hljs-built_in">cross</span>(point) &gt;= <span class="hljs-number">0</span>)
            l = mid;
        <span class="hljs-keyword">else</span>
            r = mid;
    }
    <span class="hljs-type">int</span> pos = l;
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">pointInTriangle</span>(seq[pos], seq[pos + <span class="hljs-number">1</span>], <span class="hljs-built_in">pt</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), point);
}
</code></pre>
<h2 id="sweep-line-2d">Sweep Line 2d</h2>
<p>Ele verifica somente quando as linhas comecam ou terminam. Verifica se dois segmentos de reta se interceptam, e caso sim, retorna eles.</p>
<pre><code class="language-cpp"><span class="hljs-type">const</span> <span class="hljs-type">double</span> EPS = <span class="hljs-number">1E-9</span>;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">pt</span> {
    <span class="hljs-type">double</span> x, y;
};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">seg</span> {
    pt p, q;
    <span class="hljs-type">int</span> id;

    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">get_y</span><span class="hljs-params">(<span class="hljs-type">double</span> x)</span> <span class="hljs-type">const</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">abs</span>(p.x - q.x) &lt; EPS)
            <span class="hljs-keyword">return</span> p.y;
        <span class="hljs-keyword">return</span> p.y + (q.y - p.y) * (x - p.x) / (q.x - p.x);
    }
};

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">intersect1d</span><span class="hljs-params">(<span class="hljs-type">double</span> l1, <span class="hljs-type">double</span> r1, <span class="hljs-type">double</span> l2, <span class="hljs-type">double</span> r2)</span> </span>{
    <span class="hljs-keyword">if</span> (l1 &gt; r1)
        <span class="hljs-built_in">swap</span>(l1, r1);
    <span class="hljs-keyword">if</span> (l2 &gt; r2)
        <span class="hljs-built_in">swap</span>(l2, r2);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(l1, l2) &lt;= <span class="hljs-built_in">min</span>(r1, r2) + EPS;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">vec</span><span class="hljs-params">(<span class="hljs-type">const</span> pt&amp; a, <span class="hljs-type">const</span> pt&amp; b, <span class="hljs-type">const</span> pt&amp; c)</span> </span>{
    <span class="hljs-type">double</span> s = (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">abs</span>(s) &lt; EPS ? <span class="hljs-number">0</span> : s &gt; <span class="hljs-number">0</span> ? +<span class="hljs-number">1</span> : <span class="hljs-number">-1</span>;
}

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">intersect</span><span class="hljs-params">(<span class="hljs-type">const</span> seg&amp; a, <span class="hljs-type">const</span> seg&amp; b)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">intersect1d</span>(a.p.x, a.q.x, b.p.x, b.q.x) &amp;&amp;
           <span class="hljs-built_in">intersect1d</span>(a.p.y, a.q.y, b.p.y, b.q.y) &amp;&amp;
           <span class="hljs-built_in">vec</span>(a.p, a.q, b.p) * <span class="hljs-built_in">vec</span>(a.p, a.q, b.q) &lt;= <span class="hljs-number">0</span> &amp;&amp;
           <span class="hljs-built_in">vec</span>(b.p, b.q, a.p) * <span class="hljs-built_in">vec</span>(b.p, b.q, a.q) &lt;= <span class="hljs-number">0</span>;
}

<span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span>&lt;(<span class="hljs-type">const</span> seg&amp; a, <span class="hljs-type">const</span> seg&amp; b)
{
    <span class="hljs-type">double</span> x = <span class="hljs-built_in">max</span>(<span class="hljs-built_in">min</span>(a.p.x, a.q.x), <span class="hljs-built_in">min</span>(b.p.x, b.q.x));
    <span class="hljs-keyword">return</span> a.<span class="hljs-built_in">get_y</span>(x) &lt; b.<span class="hljs-built_in">get_y</span>(x) - EPS;
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">event</span> {
    <span class="hljs-type">double</span> x;
    <span class="hljs-type">int</span> tp, id;

    <span class="hljs-built_in">event</span>() {}
    <span class="hljs-built_in">event</span>(<span class="hljs-type">double</span> x, <span class="hljs-type">int</span> tp, <span class="hljs-type">int</span> id) : <span class="hljs-built_in">x</span>(x), <span class="hljs-built_in">tp</span>(tp), <span class="hljs-built_in">id</span>(id) {}

    <span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span>&lt;(<span class="hljs-type">const</span> event&amp; e) <span class="hljs-type">const</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">abs</span>(x - e.x) &gt; EPS)
            <span class="hljs-keyword">return</span> x &lt; e.x;
        <span class="hljs-keyword">return</span> tp &gt; e.tp;
    }
};

set&lt;seg&gt; s;
vector&lt;set&lt;seg&gt;::iterator&gt; where;

set&lt;seg&gt;::<span class="hljs-function">iterator <span class="hljs-title">prev</span><span class="hljs-params">(set&lt;seg&gt;::iterator it)</span> </span>{
    <span class="hljs-keyword">return</span> it == s.<span class="hljs-built_in">begin</span>() ? s.<span class="hljs-built_in">end</span>() : --it;
}

set&lt;seg&gt;::<span class="hljs-function">iterator <span class="hljs-title">next</span><span class="hljs-params">(set&lt;seg&gt;::iterator it)</span> </span>{
    <span class="hljs-keyword">return</span> ++it;
}

<span class="hljs-function">pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; <span class="hljs-title">solve</span><span class="hljs-params">(<span class="hljs-type">const</span> vector&lt;seg&gt;&amp; a)</span> </span>{
    <span class="hljs-type">int</span> n = (<span class="hljs-type">int</span>)a.<span class="hljs-built_in">size</span>();
    vector&lt;event&gt; e;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; ++i) {
        e.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">event</span>(<span class="hljs-built_in">min</span>(a[i].p.x, a[i].q.x), +<span class="hljs-number">1</span>, i));
        e.<span class="hljs-built_in">push_back</span>(<span class="hljs-built_in">event</span>(<span class="hljs-built_in">max</span>(a[i].p.x, a[i].q.x), <span class="hljs-number">-1</span>, i));
    }
    <span class="hljs-built_in">sort</span>(e.<span class="hljs-built_in">begin</span>(), e.<span class="hljs-built_in">end</span>());

    s.<span class="hljs-built_in">clear</span>();
    where.<span class="hljs-built_in">resize</span>(a.<span class="hljs-built_in">size</span>());
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; e.<span class="hljs-built_in">size</span>(); ++i) {
        <span class="hljs-type">int</span> id = e[i].id;
        <span class="hljs-keyword">if</span> (e[i].tp == +<span class="hljs-number">1</span>) {
            set&lt;seg&gt;::iterator nxt = s.<span class="hljs-built_in">lower_bound</span>(a[id]), prv = <span class="hljs-built_in">prev</span>(nxt);
            <span class="hljs-keyword">if</span> (nxt != s.<span class="hljs-built_in">end</span>() &amp;&amp; <span class="hljs-built_in">intersect</span>(*nxt, a[id]))
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">make_pair</span>(nxt-&gt;id, id);
            <span class="hljs-keyword">if</span> (prv != s.<span class="hljs-built_in">end</span>() &amp;&amp; <span class="hljs-built_in">intersect</span>(*prv, a[id]))
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">make_pair</span>(prv-&gt;id, id);
            where[id] = s.<span class="hljs-built_in">insert</span>(nxt, a[id]);
        } <span class="hljs-keyword">else</span> {
            set&lt;seg&gt;::iterator nxt = <span class="hljs-built_in">next</span>(where[id]), prv = <span class="hljs-built_in">prev</span>(where[id]);
            <span class="hljs-keyword">if</span> (nxt != s.<span class="hljs-built_in">end</span>() &amp;&amp; prv != s.<span class="hljs-built_in">end</span>() &amp;&amp; <span class="hljs-built_in">intersect</span>(*nxt, *prv))
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">make_pair</span>(prv-&gt;id, nxt-&gt;id);
            s.<span class="hljs-built_in">erase</span>(where[id]);
        }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">make_pair</span>(<span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>);
}
</code></pre>
<h1 id="volume-poliedros">Volume Poliedros</h1>
<ul>
<li>Esfera: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>4</mn><mi mathvariant="normal">/</mi><mn>3</mn><mo stretchy="false">)</mo><mo>∗</mo><mi>p</mi><mi>i</mi><mo>∗</mo><msup><mi>r</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">(4/3) * pi * r^{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">4/3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>Pirâmide: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>B</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>∗</mo><mi>a</mi><mi>l</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>a</mi><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">areaBase * altura / 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">re</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">a</span><span class="mord mathnormal">se</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">lt</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord">/3</span></span></span></span></li>
</ul>
<h1 id="area-de-formas">Area de Formas</h1>
<h2 id="triangulos-fórmula-de-herão">Triangulos (Fórmula de Herão)</h2>
<p>Formula geral usando semi perimetro e seja tamanho dos lados do triangulo <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> e <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>.</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>=</mo><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>c</mi></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">    p = \frac{a+b+c}{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>=</mo><msqrt><mrow><mi>p</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>a</mi><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mi>c</mi><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></msqrt></mrow><annotation encoding="application/x-tex">    A = \sqrt{p*(a-p)*(b-p) * (c-p)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.2561em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9839em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span><span style="top:-2.9439em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2561em;"><span></span></span></span></span></span></span></span></span></span></p>
<h2 id="área-de-polígonos-regulares-de-n-lados-e-lado-l">Área de Polígonos Regulares (de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> lados e lado <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>)</h2>
<p><strong>Definição:</strong> Um polígono regular é <strong>CONVEXO</strong> e possui todos os lados e ângulos <strong>IGUAIS</strong>.</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> é o apótema (tamanho do segmento que liga o centro ao ponto médio de um dos lados fazendo um ângulo de 90 graus)</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> é o perímetro (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>∗</mo><mi>l</mi></mrow><annotation encoding="application/x-tex">n * l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>)</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>=</mo><mfrac><mrow><mi>p</mi><mo>∗</mo><mi>a</mi></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">    A = \frac{p * a}{2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8283em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1423em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h2 id="lista-de-apótemas">Lista de apótemas</h2>
<ul>
<li>triângulo: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mrow><mi>l</mi><mo>∗</mo><msqrt><mn>2</mn></msqrt></mrow><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">a = \frac{l * \sqrt{2}}{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.383em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.038em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.399em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">∗</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">2</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>quadrado: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mi>l</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">a = \frac{l}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>hexágono: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mrow><mi>l</mi><mo>∗</mo><msqrt><mn>3</mn></msqrt></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">a = \frac{l * \sqrt{3}}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.383em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.038em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.399em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">∗</span><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9128em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">3</span></span></span><span style="top:-2.8728em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1272em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
<h1 id="formulas-genericas-de-pontos">Formulas genericas de pontos</h1>
<p>Material com estruturas e funcoes prontas para trabalhar com pontos 2D e 3D. As implementacoes sao para pontos em 3D, pois sao maiores do que as 2D.</p>
<h2 id="definicao-da-estrutura">Definicao da estrutura</h2>
<pre><code class="language-cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">point3d</span> {
    ftype x, y, z;
    <span class="hljs-built_in">point3d</span>() {}
    <span class="hljs-built_in">point3d</span>(ftype x, ftype y, ftype z): <span class="hljs-built_in">x</span>(x), <span class="hljs-built_in">y</span>(y), <span class="hljs-built_in">z</span>(z) {}
    point3d&amp; <span class="hljs-keyword">operator</span>+=(<span class="hljs-type">const</span> point3d &amp;t) {
        x += t.x;
        y += t.y;
        z += t.z;
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
    }
    point3d&amp; <span class="hljs-keyword">operator</span>-=(<span class="hljs-type">const</span> point3d &amp;t) {
        x -= t.x;
        y -= t.y;
        z -= t.z;
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
    }
    point3d&amp; <span class="hljs-keyword">operator</span>*=(ftype t) {
        x *= t;
        y *= t;
        z *= t;
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
    }
    point3d&amp; <span class="hljs-keyword">operator</span>/=(ftype t) {
        x /= t;
        y /= t;
        z /= t;
        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
    }
    point3d <span class="hljs-keyword">operator</span>+(<span class="hljs-type">const</span> point3d &amp;t) <span class="hljs-type">const</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">point3d</span>(*<span class="hljs-keyword">this</span>) += t;
    }
    point3d <span class="hljs-keyword">operator</span>-(<span class="hljs-type">const</span> point3d &amp;t) <span class="hljs-type">const</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">point3d</span>(*<span class="hljs-keyword">this</span>) -= t;
    }
    point3d <span class="hljs-keyword">operator</span>*(ftype t) <span class="hljs-type">const</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">point3d</span>(*<span class="hljs-keyword">this</span>) *= t;
    }
    point3d <span class="hljs-keyword">operator</span>/(ftype t) <span class="hljs-type">const</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">point3d</span>(*<span class="hljs-keyword">this</span>) /= t;
    }
};
point3d <span class="hljs-keyword">operator</span>*(ftype a, point3d b) {
    <span class="hljs-keyword">return</span> b * a;
}
</code></pre>
<h2 id="funcoes-genericas">Funcoes genericas</h2>
<pre><code class="language-cpp"><span class="hljs-function">ftype <span class="hljs-title">dot</span><span class="hljs-params">(point3d a, point3d b)</span> </span>{
    <span class="hljs-keyword">return</span> a.x * b.x + a.y * b.y + a.z * b.z;
}
<span class="hljs-function">ftype <span class="hljs-title">norm</span><span class="hljs-params">(point3d a)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">dot</span>(a, a);
}
<span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">abs</span><span class="hljs-params">(point3d a)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sqrt</span>(<span class="hljs-built_in">norm</span>(a));
}
<span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">proj</span><span class="hljs-params">(point3d a, point3d b)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">dot</span>(a, b) / <span class="hljs-built_in">abs</span>(b);
}
<span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">angle</span><span class="hljs-params">(point3d a, point3d b)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">acos</span>(<span class="hljs-built_in">dot</span>(a, b) / <span class="hljs-built_in">abs</span>(a) / <span class="hljs-built_in">abs</span>(b));
}
<span class="hljs-function">point3d <span class="hljs-title">cross</span><span class="hljs-params">(point3d a, point3d b)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">point3d</span>(a.y * b.z - a.z * b.y,
                   a.z * b.x - a.x * b.z,
                   a.x * b.y - a.y * b.x);
}
<span class="hljs-function">ftype <span class="hljs-title">triple</span><span class="hljs-params">(point3d a, point3d b, point3d c)</span> </span>{ <span class="hljs-comment">// Calcula area de poligono determinado pelos vetores a, b e c.</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">dot</span>(a, <span class="hljs-built_in">cross</span>(b, c));
}
</code></pre>

            <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
            
        </body>
        </html>